<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G.E.N.A.I+ Maturity Transformation Framework</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; height: 400px; max-height: 50vh; }
        .small-chart-container { position: relative; width: 100%; max-width: 400px; margin-left: auto; margin-right: auto; height: 350px; max-height: 45vh; }
        @media (min-width: 768px) { .chart-container { height: 450px; } }
        .nav-link { transition: color 0.3s; }
        .nav-link:hover { color: #d8b4fe; }
        
        #maturity-matrix-grid {
            display: grid;
            grid-template-columns: 6rem repeat(5, 1fr);
            gap: 0.5rem;
        }

        .matrix-cell { 
            transition: all 0.2s ease-in-out;
            aspect-ratio: 1 / 1;
        }
        .matrix-cell.selectable:hover { 
            transform: scale(1.1); 
            z-index: 10; 
            box-shadow: 0 0 15px rgba(167, 139, 250, 0.7);
            border-color: #a78bfa;
        }
        .matrix-cell.current-selection { background-color: #fbbf24 !important; color: #78350f; border: 2px solid #f59e0b; }
        .matrix-cell.target-selection { background-color: #6d28d9 !important; color: white; border: 2px solid #a78bfa; }
        .matrix-cell.disabled { cursor: not-allowed; filter: grayscale(80%) opacity(50%); }
        .matrix-cell.recommended-target {
            animation: pulse-glow 2s infinite;
        }
        .matrix-cell.calculated-average-highlight {
            animation: pulse-border 2s infinite;
            border: 3px solid #10B981;
        }
        
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }

        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        #path-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }
        
        .lifecycle-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
        }
        .lifecycle-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            transition: all 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
        }
        .lifecycle-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .lifecycle-header {
            border-top-left-radius: 0.75rem;
            border-top-right-radius: 0.75rem;
        }
    
        .highlight-current { background-color: rgba(251, 191, 36, 0.2) !important; }
        .highlight-target { background-color: rgba(167, 139, 250, 0.2) !important; }

        /* Styles for Animated Intro */
        .intro-matrix-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 4px;
            position: relative;
        }
        .intro-grid-cell {
            border-radius: 8px;
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .intro-header-cell, .intro-label-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            text-align: center;
            border-radius: 8px;
            color: white;
        }
        .intro-pod-size-label {
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            background-color: #7c3aed;
        }
        .intro-level-label {
             background-color: #9d4edd;
        }

        .intro-highlight-cell {
            transform: scale(1.08) translateZ(20px);
            box-shadow: 0 0 30px rgba(167, 139, 250, 0.7);
            z-index: 10;
            border: 2px solid rgba(139, 92, 246, 0.9);
        }
        .intro-uplift-path {
            position: absolute;
            stroke: #4f46e5;
            stroke-width: 3px;
            stroke-dasharray: 8 8;
            fill: none;
            opacity: 0;
            stroke-dashoffset: 1000;
            transition: opacity 0.5s ease-in-out, stroke-dashoffset 2.5s ease-in-out;
        }
        .intro-uplift-path.visible {
            opacity: 0.8;
            stroke-dashoffset: 0;
        }
        .intro-path-dot {
             position: absolute;
             width: 16px;
             height: 16px;
             background-color: #4f46e5;
             border-radius: 50%;
             transform: translate(-50%, -50%);
             opacity: 0;
             transition: opacity 0.5s ease-in-out 0.5s;
             box-shadow: 0 0 10px #4f46e5;
        }
        .intro-path-dot.visible {
             opacity: 1;
        }
        .intro-header-grounded { background-color: #9d4edd; }
        .intro-header-established { background-color: #7b2cbf; }
        .intro-header-navigating { background-color: #5a189a; }
        .intro-header-agentic { background-color: #3c096c; }
        .intro-header-intelligentplus { background-color: #240046; }
        
        .intro-grid-cell[data-level='0'] { background-color: rgba(157, 78, 221, 0.4); }
        .intro-grid-cell[data-level='1'] { background-color: rgba(123, 44, 191, 0.5); }
        .intro-grid-cell[data-level='2'] { background-color: rgba(90, 24, 154, 0.6); }
        .intro-grid-cell[data-level='3'] { background-color: rgba(60, 9, 108, 0.7); }
        .intro-grid-cell[data-level='4'] { background-color: rgba(36, 0, 70, 0.8); }
        
        .intro-timeline-bar {
             background: linear-gradient(to right, #9d4edd, #7b2cbf, #5a189a, #3c096c, #240046);
        }

        .play-button {
            transition: all 0.3s ease;
        }
        .play-button:disabled {
            cursor: not-allowed;
            background-color: #6b7280;
            opacity: 0.5;
        }
        
        /* Levels Explainer Styles */
        .level-card {
            transition: all 0.3s ease-in-out;
            border-width: 2px;
            border-color: transparent;
        }
        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: currentColor;
        }
        
        /* Heatmap Styles */
        .heatmap-grid {
            display: grid;
            gap: 4px;
        }
        .heatmap-cell {
            padding: 0.5rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            min-height: 50px;
        }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="upload-overlay" class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center transition-opacity duration-500">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full text-center transform transition-all duration-500 scale-95 opacity-0" id="upload-card">
            <h2 class="text-3xl font-extrabold text-slate-900 mb-2">Welcome to the SRE Maturity App</h2>
            <p class="text-slate-600 mb-6">To power the performance dashboard, please upload an Excel file.</p>
            <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 text-left text-sm mb-6">
                <p class="font-semibold mb-2">Excel File Requirements:</p>
                <ul class="list-disc list-inside text-slate-600 space-y-1">
                    <li>A sheet named <strong class="text-purple-600">DashboardData</strong>.</li>
                    <li>Columns: <strong class="text-purple-600">Project, Team, PodSize, Metric, Score</strong>.</li>
                </ul>
                <a href="data:text/csv;charset=utf-8,Project,Team,PodSize,Metric,Score%0ACapability,AMS,L,Toil%20Management,3%0ACapability,AMS,L,Incident%20Response,2%0ACapability,AMS,L,Observability%20&%20Monitoring,2%0ACapability,AMS,L,SLOS%20/%20SLIs,1%0ACapability,AMS,L,Learning%20Reviews,3%0ACapability,AMS,L,Knowledge%20Systems,2%0ACapability,AMS,L,Tooling,2%0ACapability,AMS,L,Chaos%20Engineering,1%0ACapability,IMS,S,Toil%20Management,4%0ACapability,IMS,S,Incident%20Response,4%0ACapability,IMS,S,Observability%20&%20Monitoring,3%0ACapability,IMS,S,SLOS%20/%20SLIs,2%0ACapability,IMS,S,Learning%20Reviews,4%0ACapability,IMS,S,Knowledge%20Systems,3%0ACapability,IMS,S,Tooling,3%0ACapability,IMS,S,Chaos%20Engineering,2%0ACapability,PMO,XS,Toil%20Management,1%0ACapability,PMO,XS,Incident%20Response,1%0ACapability,PMO,XS,Observability%20&%20Monitoring,1%0ACapability,PMO,XS,SLOS%20/%20SLIs,1%0ACapability,PMO,XS,Learning%20Reviews,1%0ACapability,PMO,XS,Knowledge%20Systems,1%0ACapability,PMO,XS,Tooling,1%0ACapability,PMO,XS,Chaos%20Engineering,0" download="SRE_Dashboard_Template.csv" class="text-purple-600 hover:underline mt-2 inline-block">Download Sample Template (.csv)</a>
            </div>
            <input type="file" id="excel-upload-input" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100 mb-4" accept=".xlsx, .xls, .csv">
            <button id="process-file-btn" class="w-full bg-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-purple-700 transition duration-300 disabled:bg-slate-400 disabled:cursor-not-allowed" disabled>Process File</button>
            <button id="continue-sample-btn" class="w-full bg-slate-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-slate-700 transition duration-300 mt-2">Continue with Sample Data</button>
        </div>
    </div>

    <div id="main-content" class="opacity-0 transition-opacity duration-500">
        <header class="bg-slate-900/80 backdrop-blur-sm text-white sticky top-0 z-40 shadow-md" style="background-color: #3c096c;">
            <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
                <h1 class="text-xl md:text-2xl font-bold text-white">ATCP-SRE</h1>
                <div class="hidden md:flex items-center space-x-6 text-sm font-medium">
                    <a href="#framework" class="nav-link">Framework</a>
                    <a href="#dashboard" class="nav-link">Dashboard</a>
                    <a href="#maturity-levels-explainer" class="nav-link">Maturity Levels</a>
                    <a href="#maturity-intro" class="nav-link">Maturity Matrix</a>
                    <a href="#explorer" class="nav-link">Explorer</a>
                    <a href="#recommendations" class="nav-link">Recommendations</a>
                    <a href="#lifecycle" class="nav-link">Lifecycle</a>
                    <a href="#readiness-assessment" class="nav-link">Readiness</a>
                </div>
                <button id="mobile-menu-button" class="md-hidden focus:outline-none">
                    <span class="text-3xl">‚â°</span>
                </button>
            </nav>
            <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 space-y-2">
                <a href="#framework" class="block nav-link">Framework</a>
                <a href="#dashboard" class="block nav-link">Dashboard</a>
                <a href="#maturity-levels-explainer" class="block nav-link">Maturity Levels</a>
                <a href="#maturity-intro" class="block nav-link">Maturity Matrix</a>
                <a href="#explorer" class="block nav-link">Explorer</a>
                <a href="#recommendations" class="block nav-link">Recommendations</a>
                <a href="#lifecycle" class="block nav-link">Lifecycle</a>
                <a href="#readiness-assessment" class="block nav-link">Readiness</a>
            </div>
        </header>

        <main class="container mx-auto p-4 md:p-8">
            
            <section id="framework" class="mb-16 scroll-mt-24">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">The G.E.N.A.I+ Maturity Transformation Framework</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mx-auto">An evolutionary roadmap to transform operations from manual processes to GenAI-enabled, autonomous resilience.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Maturity Levels will be injected here by JS -->
                </div>
            </section>

            <section id="dashboard" class="mb-16 scroll-mt-24">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">Performance Dashboard</h2>
                    <p class="text-md text-slate-600 max-w-2xl mx-auto">This dashboard visualizes the maturity data from the uploaded file. Use the dropdowns to explore different projects and teams.</p>
                </div>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                     <div class="flex flex-col md:flex-row gap-4 mb-8 items-center">
                        <div class="flex-1">
                            <label for="project-select" class="block text-sm font-medium text-slate-700 mb-1">Select a Project:</label>
                            <select id="project-select" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm"></select>
                        </div>
                         <div class="flex-1">
                            <label for="team-select" class="block text-sm font-medium text-slate-700 mb-1">Select a Team:</label>
                            <select id="team-select" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm"></select>
                        </div>
                         <div id="average-maturity-display" class="flex-1 text-center">
                             <!-- Average maturity badge will be injected here -->
                         </div>
                        <div class="flex items-end">
                             <button id="reupload-btn" class="bg-slate-200 text-slate-700 text-sm font-bold py-2 px-4 rounded-md hover:bg-slate-300 transition h-10">Upload New Data</button>
                        </div>
                    </div>

                    <div id="dashboard-content">
                         <div class="mb-12">
                            <h3 class="text-2xl font-bold text-center mb-6 text-slate-800">Maturity Level Heatmap</h3>
                            <div id="heatmap-container" class="overflow-x-auto"></div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                            <div class="lg:col-span-2">
                                <div class="chart-container">
                                    <canvas id="sre-kpi-chart"></canvas>
                                </div>
                            </div>
                            <div>
                                <div class="small-chart-container">
                                    <canvas id="toil-chart"></canvas>
                                </div>
                            </div>
                             <div>
                                <div class="small-chart-container">
                                     <canvas id="maturity-radar-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="maturity-levels-explainer" class="mb-16 bg-white p-6 md:p-8 rounded-2xl shadow-lg scroll-mt-24">
                 <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">Maturity Levels Explained</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mx-auto">Hover over a card to learn more about each maturity level.</p>
                </div>
                <div class="grid xl:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-6" id="levels-infographic-container">
                    <!-- Infographic cards will be generated here -->
                </div>
            </section>

            <section id="maturity-intro" class="mb-16 bg-white p-6 md:p-8 rounded-2xl shadow-lg scroll-mt-24">
                <div class="w-full max-w-4xl mx-auto">
                    <h2 class="text-4xl font-bold text-center mb-8 text-slate-900">PODs Matrix Explained</h2>
                    <div class="relative">
                        <div class="intro-matrix-grid" id="intro-matrix-grid">
                            <div class="intro-header-cell"></div>
                            <div class="intro-header-cell intro-header-grounded">GROUNDED</div>
                            <div class="intro-header-cell intro-header-established">ESTABLISHED</div>
                            <div class="intro-header-cell intro-header-navigating">NAVIGATING</div>
                            <div class="intro-header-cell intro-header-agentic">AGENTIC</div>
                            <div class="intro-header-cell intro-header-intelligentplus">INTELLIGENT+</div>

                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-5">Extra-large</div>
                            <div class="intro-grid-cell" id="intro-cell-0-5" data-level="0"></div><div class="intro-grid-cell" id="intro-cell-1-5" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-5" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-5" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-5" data-level="4"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-4">Large</div>
                            <div class="intro-grid-cell" id="intro-cell-0-4" data-level="0"></div><div class="intro-grid-cell" id="intro-cell-1-4" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-4" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-4" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-4" data-level="4"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-3">Medium</div>
                            <div class="intro-grid-cell" id="intro-cell-0-3" data-level="0"></div><div class="intro-grid-cell" id="intro-cell-1-3" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-3" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-3" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-3" data-level="4"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-2">Small</div>
                            <div class="intro-grid-cell" id="intro-cell-0-2" data-level="0"></div><div class="intro-grid-cell" id="intro-cell-1-2" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-2" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-2" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-2" data-level="4"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-1">XS</div>
                            <div class="intro-grid-cell" id="intro-cell-0-1" data-level="0"></div><div class="intro-grid-cell" id="intro-cell-1-1" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-1" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-1" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-1" data-level="4"></div>

                            <div class="intro-label-cell text-slate-700">POD SIZES</div>
                            <div class="intro-label-cell intro-level-label" id="intro-level-label-0">Level 0</div><div class="intro-label-cell intro-level-label" id="intro-level-label-1">Level 1</div><div class="intro-label-cell intro-level-label" id="intro-level-label-2">Level 2</div><div class="intro-label-cell intro-level-label" id="intro-level-label-3">Level 3</div><div class="intro-label-cell intro-level-label" id="intro-level-label-4">Level 4</div>
                        </div>

                        <svg id="uplift-svg" width="100%" height="100%" style="position: absolute; top: 0; left: 0; pointer-events: none;">
                            <path id="path1" d="" class="intro-uplift-path"/><path id="path2" d="" class="intro-uplift-path"/><path id="path3" d="" class="intro-uplift-path"/><path id="path4" d="" class="intro-uplift-path"/>
                        </svg>
                        <div id="dots-container" style="position: absolute; top: 0; left: 0; width:100%; height:100%; pointer-events: none;"></div>
                    </div>

                    <div class="mt-4 text-center">
                        <div class="inline-block w-full h-4 rounded-full intro-timeline-bar"></div>
                        <p class="text-sm text-slate-600 mt-2">Shortest timeline <span class="mx-4"> &harr; </span> Longest timeline per level</p>
                    </div>
                    <div class="text-center mt-8">
                        <button id="play-animation-btn" class="play-button bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-lg text-xl focus:outline-none focus:ring-4 focus:ring-purple-300">
                            ‚ñ∂ Play PODs Animation
                        </button>
                    </div>
                </div>
            </section>


            <section id="explorer" class="mb-16 bg-white p-6 md:p-8 rounded-2xl shadow-lg scroll-mt-24">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">Interactive Maturity Explorer</h2>
                    <p class="text-md text-slate-600 max-w-3xl mx-auto">Select your team's current maturity, then its target. The tool will visualize the uplift path and generate tailored recommendations.</p>
                </div>

                <div class="flex flex-col md:flex-row items-center justify-center gap-4 mb-6">
                     <p id="selection-prompt" class="text-lg font-semibold text-purple-700">Select your CURRENT maturity</p>
                     <button id="reset-selection-btn" class="bg-slate-200 text-slate-700 text-sm font-bold py-2 px-4 rounded-full hover:bg-slate-300 transition hidden">Reset Selection</button>
                </div>
                
                <div id="maturity-matrix-container" class="relative max-w-3xl mx-auto">
                     <div id="maturity-matrix-grid">
                        <!-- Matrix cells will be injected here -->
                     </div>
                     <canvas id="path-canvas"></canvas>
                </div>

                <div id="metric-details-container" class="mt-12 opacity-0 transition-opacity duration-500">
                    <h3 class="text-2xl font-bold text-center mb-6">Metric Requirements for Target: <span id="target-level-display" class="text-purple-600"></span></h3>
                    <div id="metric-details" class="overflow-x-auto">
                        <!-- Metric details table will be injected here -->
                    </div>
                </div>
            </section>

            <section id="recommendations" class="mb-16 scroll-mt-24">
                 <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-900">Team Size Recommendations</h2>
                    <p class="text-md text-slate-600 max-w-2xl mx-auto">Based on your target selection in the explorer, here is the recommended POD structure and team composition.</p>
                </div>
                <div id="pod-recommendation-container" class="bg-white p-8 rounded-2xl shadow-lg transition-all duration-500 ease-in-out opacity-0">
                    <!-- POD recommendation will be injected here -->
                </div>
            </section>

            <section id="lifecycle" class="mb-16 scroll-mt-24">
                 <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">ATCP SRE MATURITY IMPLEMENTATION LIFECYCLE</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mx-auto">Follow this 6-step roadmap to implement the G.E.N.A.I+ framework, moving from initial assessment to certified maturity.</p>
                </div>
                <div id="lifecycle-steps" class="lifecycle-grid">
                    <!-- Lifecycle steps will be injected here -->
                </div>
            </section>

            <section id="readiness-assessment" class="mb-16 scroll-mt-24">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">DIGITAL TRANSFORMATION & AGENTIC AUTOMATION READINESS ASSESSMENT</h2>
                </div>
                <div class="bg-white p-8 rounded-2xl shadow-lg">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                        <div class="space-y-6">
                            <div class="flex items-center gap-4">
                                <div class="text-center">
                                    <div class="bg-purple-200 rounded-full p-3 inline-block">
                                        <svg class="w-8 h-8 text-purple-700" fill="currentColor" viewBox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path></svg>
                                    </div>
                                    <p class="text-sm font-semibold mt-1">Delivery Leads / Tower Leads</p>
                                </div>
                                <svg class="w-12 h-12 text-slate-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                                <div class="text-center">
                                    <div class="bg-purple-600 text-white rounded-full p-4 inline-block border-4 border-purple-300">
                                        <svg class="w-10 h-10" fill="currentColor" viewBox="0 0 20 20"><path d="M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"></path></svg>
                                    </div>
                                    <p class="text-sm font-semibold mt-1">SRE Community of Ambassadors</p>
                                    <p class="text-xs text-slate-500">Nominated Experts in KPI Categories</p>
                                </div>
                            </div>
                            <div class="bg-slate-100 p-4 rounded-lg">
                                <table class="w-full text-left">
                                    <thead>
                                        <tr>
                                            <th class="bg-purple-200 text-purple-800 p-2 rounded-l-md">METRIC GROUP</th>
                                            <th class="bg-purple-600 text-white p-2 rounded-r-md">KPIs</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-t border-slate-200"><td class="p-2">Reliability Foundation</td><td class="p-2 bg-purple-100 rounded-r-md">Basics of toil, incident, monitoring</td></tr>
                                        <tr class="border-t border-slate-200"><td class="p-2">Reliability Governance</td><td class="p-2 bg-purple-100 rounded-r-md">SLOs, SLIs</td></tr>
                                        <tr class="border-t border-slate-200"><td class="p-2">Reflection & Growth</td><td class="p-2 bg-purple-100 rounded-r-md">Learning Reviews, PMs</td></tr>
                                        <tr class="border-t border-slate-200"><td class="p-2">Knowledge Empowerment & Innovation</td><td class="p-2 bg-purple-100 rounded-r-md">Tooling, Chaos, Knowledge AI</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="flex flex-col items-center justify-center space-y-4">
                            <div class="bg-purple-600 text-white text-center py-1 px-4 rounded-full text-sm">Monthly Cadence, Workshops, Use Case Creation</div>
                            <div class="relative w-64 h-64">
                                <!-- Hub and spoke diagram -->
                                <svg class="absolute inset-0 w-full h-full" viewBox="0 0 100 100">
                                    <line x1="50" y1="50" x2="50" y2="10" stroke="#9333ea" stroke-width="1"/>
                                    <line x1="50" y1="50" x2="90" y2="50" stroke="#9333ea" stroke-width="1"/>
                                    <line x1="50" y1="50" x2="50" y2="90" stroke="#9333ea" stroke-width="1"/>
                                    <line x1="50" y1="50" x2="10" y2="50" stroke="#9333ea" stroke-width="1"/>
                                    <line x1="50" y1="50" x2="25" y2="25" stroke="#9333ea" stroke-width="1"/>
                                    <line x1="50" y1="50" x2="75" y2="75" stroke="#9333ea" stroke-width="1"/>
                                </svg>
                                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 h-20 bg-purple-700 rounded-full flex items-center justify-center">
                                    <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg>
                                </div>
                                <div class="absolute top-0 left-1/2 -translate-x-1/2 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                                <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                                <div class="absolute left-0 top-1/2 -translate-y-1/2 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                                <div class="absolute right-0 top-1/2 -translate-y-1/2 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                                <div class="absolute top-1/4 left-1/4 -translate-x-1/4 -translate-y-1/4 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                                <div class="absolute bottom-1/4 right-1/4 translate-x-1/4 translate-y-1/4 w-12 h-12 bg-purple-500 rounded-full flex items-center justify-center"><svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                            </div>
                            <div class="space-y-2 text-center">
                                <div class="bg-purple-600 text-white py-2 px-4 rounded-md text-sm">Lead Ambassador will collect details, scenarios, metric logging</div>
                                <div class="bg-purple-600 text-white py-2 px-4 rounded-md text-sm">Retrospective - What went well? What didn't go well?</div>
                                <div class="bg-purple-600 text-white py-2 px-4 rounded-md text-sm">Readiness of the account to implement digital transformation and agentic automation</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="bg-slate-800 text-slate-400 mt-16 py-8">
            <div class="container mx-auto px-6 text-center text-sm">
                <p>&copy; 2025 ATCP SRE Automation Maturity Framework. All data derived from the source report.</p>
                <p class="mt-2">This is an interactive visualization for educational and assessment purposes.</p>
            </div>
        </footer>
    </div>
    <script>
        const maturityLevelsData = [ { level: 0, name: 'GROUNDED', desc: 'Manual, reactive, and high toil.', icon: 'ÔøΩ', analogy: "Reacts only when there's a fire. Waits for alarms, puts out fires manually. No preparation, just damage control." }, { level: 1, name: 'ESTABLISHED', desc: 'Structured SOPs, basic observability and metrics.', icon: 'üõ†Ô∏è', analogy: "Has a toolkit and standard procedures. Follows checklists and fixes issues faster, but still reacts to problems after they happen." }, { level: 2, name: 'NAVIGATING', desc: 'Insight-Driven.', icon: 'ü©∫', analogy: "Recognizes recurring symptoms. Uses patterns and history to understand root causes. Starts thinking instead of just fixing." }, { level: 3, name: 'AGENTIC', desc: 'Agent-led systems.', icon: 'üîÆ', analogy: "GenAI agents act, resolve, and optimize autonomously with minimal human input." }, { level: 4, name: 'INTELLIGENT+', desc: 'Emergent, reflexive AI systems.', icon: 'ü§ñ', analogy: "AI-to-AI Ecosystem - AI simulates, breaks, and fixes infra." } ];
        const podSizes = ['XL', 'L', 'M', 'S', 'XS'];
        const levels = [0, 1, 2, 3, 4];
        
        const podDataMatrix = {
             'XS': { category: 'Foundational', roles: { 'SRE Analyst': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 20 }, 'GenAI Ambassador': { count: 1, alloc: 20 }, 'App SME': { count: 1, alloc: 20 } } },
            'S': { category: 'Foundational', roles: { 'SRE Analysts': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 50 }, 'PM': { count: 1, alloc: 50 }, 'App SME': { count: 1, alloc: 30 } } },
            'M': { category: 'Growth', roles: { 'SRE Ambassador': { count: 1, alloc: 100 }, 'SRE Analyst': { count: 1, alloc: 100 }, 'Data Analyst': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'Tooling / Application SME': { count: 1, alloc: 80 } } },
            'L': { category: 'Strategic', roles: { 'SRE Ambassador': { count: 1, alloc: 100 }, 'SRE Analysts': { count: 4, alloc: 100 }, 'Data Analysts': { count: 1, alloc: 100 }, 'Prompt Engineers': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Tooling / App SME': { count: 1, alloc: 80 } } },
            'XL': { category: 'Strategic', roles: { 'Transformation Leads': { count: 1, alloc: 100 }, 'SRE Ambassadors': { count: 1, alloc: 100 }, 'SRE Analysts': { count: 4, alloc: 100 }, 'Data Analysts': { count: 2, alloc: 100 }, 'RPA Engineers': { count: 1, alloc: 100 }, 'Prompt Engineers': { count: 2, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Application SMEs': { count: 1, alloc: 100 } } }
        };

        const metrics = [ "Toil Management", "Incident Response", "Observability & Monitoring", "SLOS / SLIs", "Learning Reviews", "Knowledge Systems", "Tooling", "Chaos Engineering" ];
        const metricCriteria = { 
            "Toil Management": ["Manual toil, no tracking, <10% automated", "10-30% automation", "30-70% automation", ">90% auto-resolved by GenAI agents", "100% zero-touch ops"],
            "Incident Response": ["No MTTR tracking", "MTTR baseline logging only", "MTTR ‚Üì 10-30%", "MTTR ‚Üì >70%, AI triage/fix", "MTTR ‚Üì >90%, autonomous resolution"],
            "Observability & Monitoring": ["Alerts only, no telemetry", "Dashboards with thresholds", "‚â•60% predictive accuracy, anomaly detection", "‚â•80% predictive accuracy, AI forecasts", "100% prediction accuracy, RCA by telemetry"],
            "SLOS / SLIs": ["No SLIS/SLOs tracked", "Basic dashboard metrics", "Error budget burn ‚â§ 1x per week", "Forecasting & policy-based actions", "AI adjusts & enforces SLO budgets"],
            "Learning Reviews": ["<10% incidents with PMs", "~30-50% incidents with PMs", "‚â•70% incidents with PM", "‚â•90% GenAI-summarized PMs", "Auto-learned, reflexive PM system"],
            "Knowledge Systems": ["SOP reuse <30%", "Tagged SOPs and basic search", "SOP reuse ‚â•70%, search acc. ‚â•90%", "GenAI evolves SOPs, predicts queries", "KB self-generates & self-corrects"],
            "Tooling": ["<25% tool unification", "CI/CD w/o intelligence", "‚â•60% unified toolchain", "‚â•90% tool consolidation, GenAI orchestrated", "Agents deploy other agents autonomously"],
            "Chaos Engineering": ["No practice", "Manual Game Days", "‚â•50% chaos recovery rate", "‚â•80% auto-recovery from chaos events", "AI simulates, breaks, heals - full automation"]
        };
        const lifecycleData = [ { step: 1, name: "Maturity Assessment", action: "Evaluate the current state of each project/team using the G.E.N.A.I.+ model.", method: "Distribute survey aligned to 8 SRE metrices including current customer satisfaction level (happiness level). Use scoring matrix to determine current level (0-4).", output: "Maturity level per metrics (e.g., Toil = 2, SLOs = 3). Sentiment Analysis." }, { step: 2, name: "Tool Inventory & Classification", action: "Identify existing tools used by the team.", method: "Audit tooling stack (e.g., Jenkins, Grafana, SNOW, LangChain, GenWizard). Tag each tool as Traditional or GenAI-enabled.", output: "Capability-to-tool matrix showing gaps or overlaps." }, { step: 3, name: "SME Engagement & Gap Analysis", action: "Engage SMEs for deeper understanding of tool usage, pain points, and blockers.", method: "Ticketed & Non-ticketed work analysis. Facilitate workshops or interviews. Identify whether tools/processes can be elevated to support the next target maturity level.", output: "Gap report + capability roadmap per team." }, { step: 4, name: "Target Level Definition", action: "Define the target maturity level per team/project.", method: "Review business goals, compliance needs, risk appetite, and strategic direction. Cross-reference with team capabilities and capacity.", output: "Capability heatmap per team/project showing: Current level (from Step 1), Target level (short-term or long-term), Prioritized gap list for each capability." }, { step: 5, name: "Transformation Plan & Execution", action: "Co-create action plans for each metric to move from current ‚Üí target.", method: "Co-design roadmap with SMEs, Engineering Leads, and SRE Ambassadors. Match capability gaps with GenAI or traditional enablers from the tech matrix.", output: "Roadmap per team with: Capability uplift initiatives, Tools/skills needed, Timeline (3-6-12-month plans), KPIs or OKRs (e.g., ‚Äúreduce MTTR by 40%‚Äù; ‚Äú100% of incidents have GenAI PM summary‚Äù)." }, { step: 6, name: "SRE Ambassador Certification (Maturity Badge Tagging)", action: "Achieve SRE Ambassador Certification (Maturity Badge Tagging).", method: "Intelligent+ (Agentic 2.0) Readiness Identification. If a team hits Level 3 in all 8 Key Metrices.", output: "X-Form Readiness Identification if team hits Level 4." } ];
        
        const sampleDashboardData = [
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Toil Management", "Score": 3 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Incident Response", "Score": 2 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Observability & Monitoring", "Score": 2 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "SLOS / SLIs", "Score": 1 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Learning Reviews", "Score": 3 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Knowledge Systems", "Score": 2 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Tooling", "Score": 2 },
            { "Project": "Capability", "Team": "AMS", "PodSize": "L", "Metric": "Chaos Engineering", "Score": 1 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Toil Management", "Score": 4 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Incident Response", "Score": 4 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Observability & Monitoring", "Score": 3 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "SLOS / SLIs", "Score": 2 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Learning Reviews", "Score": 4 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Knowledge Systems", "Score": 3 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Tooling", "Score": 3 },
            { "Project": "Capability", "Team": "IMS", "PodSize": "S", "Metric": "Chaos Engineering", "Score": 2 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Toil Management", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Incident Response", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Observability & Monitoring", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "SLOS / SLIs", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Learning Reviews", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Knowledge Systems", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Tooling", "Score": 1 },
            { "Project": "Capability", "Team": "PMO", "PodSize": "XS", "Metric": "Chaos Engineering", "Score": 0 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Toil Management", "Score": 3 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Incident Response", "Score": 3 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Observability & Monitoring", "Score": 3 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "SLOS / SLIs", "Score": 1 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Learning Reviews", "Score": 3 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Knowledge Systems", "Score": 2 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Tooling", "Score": 2 },
            { "Project": "Capability", "Team": "AMS/IMS", "PodSize": "L", "Metric": "Chaos Engineering", "Score": 1 }
        ];
        
        let dashboardData = [];

        let currentSelection = null;
        let targetSelection = null;
        let selectionPhase = 'current'; 
        let sreChart, toilChart, radarChart;
        
        document.addEventListener('DOMContentLoaded', () => {
            const uploadOverlay = document.getElementById('upload-overlay');
            const uploadCard = document.getElementById('upload-card');
            uploadOverlay.style.display = 'flex';
            setTimeout(() => {
                uploadOverlay.classList.remove('bg-slate-900/80', 'backdrop-blur-sm');
                uploadCard.classList.remove('scale-95', 'opacity-0');
            }, 100);

            const fileInput = document.getElementById('excel-upload-input');
            const processBtn = document.getElementById('process-file-btn');

            fileInput.addEventListener('change', () => {
                if (fileInput.files.length > 0) {
                    processBtn.disabled = false;
                } else {
                    processBtn.disabled = true;
                }
            });

            processBtn.addEventListener('click', () => handleFileUpload(fileInput));
            document.getElementById('continue-sample-btn').addEventListener('click', () => initializeApp(sampleDashboardData));
        });

        function initializeApp(data) {
            dashboardData = data;
            
            const uploadOverlay = document.getElementById('upload-overlay');
            const mainContent = document.getElementById('main-content');
            
            uploadOverlay.classList.add('opacity-0');
            mainContent.classList.remove('opacity-0');
            setTimeout(() => {
                uploadOverlay.style.display = 'none';
            }, 500);

            populateMaturityLevels();
            setupMobileMenu();
            populateMatrix();
            populateLifecycle();
            populateLevelsExplainer();
            initDashboard();
            initIntroAnimation();
            
            document.getElementById('reset-selection-btn').addEventListener('click', resetSelection);
            document.getElementById('reupload-btn').addEventListener('click', () => window.location.reload());
            window.addEventListener('resize', () => drawPath(true));
        }


        function populateMaturityLevels() { const container = document.querySelector('#framework .grid'); container.innerHTML = maturityLevelsData.map(level => ` <div class="bg-white p-6 rounded-xl shadow-md border-b-4 border-purple-500 transition hover:shadow-xl hover:-translate-y-1"> <div class="flex items-center mb-4"> <span class="text-4xl mr-4">${level.icon}</span> <div> <p class="text-xs font-bold uppercase tracking-wider text-purple-600">Level ${level.level}</p> <h3 class="text-xl font-bold text-slate-900">${level.name}</h3> </div> </div> <p class="text-slate-600 text-sm">${level.desc}</p> </div> `).join(''); }
        function populateLifecycle() {
            const container = document.getElementById('lifecycle-steps');
            container.innerHTML = ''; // Clear existing content
            lifecycleData.forEach(step => {
                const card = document.createElement('div');
                card.className = 'lifecycle-card flex';
                
                card.innerHTML = `
                    <div class="bg-purple-600 text-white p-4 flex flex-col items-center justify-center rounded-l-lg w-24">
                        <p class="text-xs font-bold uppercase">Step</p>
                        <p class="text-4xl font-extrabold">${step.step}</p>
                    </div>
                    <div class="p-6 flex-grow">
                        <h3 class="text-xl font-bold text-slate-900 mb-3">${step.name}</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                            <div>
                                <h4 class="font-semibold text-purple-700 mb-1">Action</h4>
                                <p class="text-slate-600">${step.action}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-purple-700 mb-1">Method</h4>
                                <p class="text-slate-600">${step.method}</p>
                            </div>
                            <div>
                                <h4 class="font-semibold text-purple-700 mb-1">Output</h4>
                                <p class="text-slate-600">${step.output}</p>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        function setupMobileMenu() { const button = document.getElementById('mobile-menu-button'); const menu = document.getElementById('mobile-menu'); button.addEventListener('click', () => { menu.classList.toggle('hidden'); }); menu.querySelectorAll('a').forEach(link => { link.addEventListener('click', () => menu.classList.add('hidden')); }); }

        function populateMatrix() {
            const gridContainer = document.getElementById('maturity-matrix-grid');
            gridContainer.innerHTML = '';
            
            const emptyCell = document.createElement('div');
            gridContainer.appendChild(emptyCell);
            
            maturityLevelsData.forEach(level => {
                const headerCell = document.createElement('div');
                headerCell.className = 'h-12 flex items-center justify-center font-bold text-slate-600 text-xs sm:text-sm md:text-base text-center';
                headerCell.textContent = level.name;
                gridContainer.appendChild(headerCell);
            });

            podSizes.forEach(size => {
                const yAxisCell = document.createElement('div');
                yAxisCell.className = 'h-full flex items-center justify-center font-bold text-slate-600 bg-slate-100 rounded text-sm md:text-base';
                yAxisCell.textContent = size;
                gridContainer.appendChild(yAxisCell);

                levels.forEach(level => {
                    const cell = document.createElement('div');
                    cell.className = 'matrix-cell selectable rounded-md cursor-pointer flex items-center justify-center text-transparent';
                    const colors = ['#e9d5ff', '#c084fc', '#9333ea', '#6b21a8', '#3b0764'];
                    cell.style.backgroundColor = colors[level];
                    cell.dataset.pod = size;
                    cell.dataset.level = level;
                    cell.id = `cell-${size}-${level}`;
                    cell.addEventListener('click', handleMatrixClick);
                    gridContainer.appendChild(cell);
                });
            });

            const bottomEmptyCell = document.createElement('div');
            gridContainer.appendChild(bottomEmptyCell);

            levels.forEach(level => {
                const footerCell = document.createElement('div');
                footerCell.className = 'h-12 flex items-center justify-center font-bold text-slate-600 text-sm md:text-base';
                footerCell.id = `footer-level-${level}`;
                footerCell.textContent = `Level ${level}`;
                gridContainer.appendChild(footerCell);
            });
        }

        function handleMatrixClick(event) {
            const cell = event.currentTarget;
            if (cell.classList.contains('disabled')) return;

            const selection = { pod: cell.dataset.pod, level: parseInt(cell.dataset.level) };

            if (selectionPhase === 'current') {
                currentSelection = selection;
                cell.classList.add('current-selection');
                
                if (currentSelection.level === 4) {
                    selectionPhase = 'done';
                    document.getElementById('selection-prompt').textContent = 'Level 4 Selected: You are at the highest level!';
                    document.getElementById('reset-selection-btn').classList.remove('hidden');
                    document.querySelectorAll('.matrix-cell.selectable').forEach(c => {
                        if (!c.classList.contains('current-selection')) c.classList.add('disabled');
                    });
                    
                } else {
                    selectionPhase = 'target';
                    document.getElementById('selection-prompt').textContent = 'Select your TARGET maturity';
                    updateDisabledCells();
                    showRecommendation();
                }
            } else if (selectionPhase === 'target') {
                targetSelection = selection;
                document.querySelectorAll('.matrix-cell').forEach(c => c.classList.remove('recommended-target'));
                clearCanvas();
                cell.classList.add('target-selection');
                selectionPhase = 'done';
                document.getElementById('selection-prompt').textContent = 'Uplift Path Selected!';
                document.getElementById('reset-selection-btn').classList.remove('hidden');
                document.querySelectorAll('.matrix-cell.selectable').forEach(c => {
                    if (!c.classList.contains('current-selection') && !c.classList.contains('target-selection')) {
                        c.classList.add('disabled');
                    }
                });
                drawPath(false, '#D97706', true);
                updateRecommendations(currentSelection.pod, currentSelection.level, targetSelection.level);
            }
        }
        
        function updateDisabledCells() {
            if (!currentSelection) return;
            document.querySelectorAll('.matrix-cell.selectable').forEach(cell => {
                const pod = cell.dataset.pod;
                const level = parseInt(cell.dataset.level);
                if (pod !== currentSelection.pod || level <= currentSelection.level) {
                     cell.classList.add('disabled');
                }
            });
        }

        function showRecommendation() {
            if (!currentSelection || currentSelection.level >= 4) return;
            const recommendedTarget = { pod: currentSelection.pod, level: 4 };
            
            const recommendedCell = document.getElementById(`cell-${recommendedTarget.pod}-${recommendedTarget.level}`);
            if(recommendedCell) {
                recommendedCell.classList.add('recommended-target');
            }
            
            drawPath(false, '#16A34A', true, recommendedTarget);
        }

        function resetSelection() {
            currentSelection = null;
            targetSelection = null;
            selectionPhase = 'current';
            document.getElementById('selection-prompt').textContent = 'Select your CURRENT maturity';
            document.getElementById('reset-selection-btn').classList.add('hidden');
            document.querySelectorAll('.matrix-cell').forEach(cell => {
                cell.classList.remove('current-selection', 'target-selection', 'disabled', 'calculated-average-highlight');
            });
            clearCanvas();
            document.getElementById('metric-details-container').classList.add('opacity-0');
            document.getElementById('pod-recommendation-container').classList.add('opacity-0');
        }
        
        function clearCanvas() {
            const canvas = document.getElementById('path-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function drawPath(isResize = false, color = '#D97706', isDashed = false, overrideTarget = null) {
            const endSelection = overrideTarget || targetSelection;
            if (!currentSelection || !endSelection) return;

            const canvas = document.getElementById('path-canvas');
            const gridContainer = document.getElementById('maturity-matrix-grid');
            const ctx = canvas.getContext('2d');

            canvas.width = gridContainer.offsetWidth;
            canvas.height = gridContainer.offsetHeight;

            const startCell = document.getElementById(`cell-${currentSelection.pod}-${currentSelection.level}`);
            const endCell = document.getElementById(`cell-${endSelection.pod}-${endSelection.level}`);
            
            if(!startCell || !endCell) return;

            const startPos = { x: startCell.offsetLeft + startCell.offsetWidth / 2, y: startCell.offsetTop };
            const endPos = { x: endCell.offsetLeft + endCell.offsetWidth / 2, y: endCell.offsetTop };
            
            const point1 = { x: startPos.x, y: startPos.y + startCell.offsetHeight };
            const point2 = { x: startPos.x, y: startPos.y};
            const point3 = { x: endPos.x, y: endPos.y};
            const point4 = { x: endPos.x, y: endPos.y + endCell.offsetHeight };

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            
            if(isDashed) {
                ctx.setLineDash([8, 6]);
            } else {
                ctx.setLineDash([]);
            }

            ctx.lineWidth = 3;
            ctx.strokeStyle = color;
            ctx.moveTo(point1.x, point1.y);
            ctx.lineTo(point2.x, point2.y);
            ctx.lineTo(point3.x, point3.y);
            ctx.lineTo(point4.x, point4.y);
            ctx.stroke();
            
            drawArrow(ctx, point3.x, point3.y, point4.x, point4.y, color);
        }

        function drawArrow(ctx, fromx, fromy, tox, toy, color) {
            const headlen = 10;
            const dx = tox - fromx;
            const dy = toy - fromy;
            const angle = Math.atan2(dy, dx);
            ctx.save();
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.setLineDash([]);
            ctx.moveTo(tox, toy);
            ctx.lineTo(tox - headlen * Math.cos(angle - Math.PI / 6), toy - headlen * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(tox, toy);
            ctx.lineTo(tox - headlen * Math.cos(angle + Math.PI / 6), toy - headlen * Math.sin(angle + Math.PI / 6));
            ctx.stroke();
            ctx.restore();
        }

        function updateRecommendations(podSize, currentLevel, targetLevel) {
            updateMetricDetailsTable(currentLevel, targetLevel);

            const podContainer = document.getElementById('pod-recommendation-container');
            let baseCompositionData = podDataMatrix[podSize];
            
            if (!baseCompositionData) {
                podContainer.innerHTML = `<p class="text-center text-slate-500">No recommendation available for this POD size.</p>`;
                podContainer.classList.remove('opacity-0');
                return;
            }

            const rolesHTML = Object.entries(baseCompositionData.roles).map(([role, details]) => {
                const allocationText = `${details.count} (${details.alloc}%)`;
                return ` <li class="flex justify-between items-center py-2 border-b border-slate-100"> <span class="font-medium">${role}</span> <span class="text-sm font-semibold text-purple-700 bg-purple-100 px-2 py-1 rounded-full">${allocationText}</span> </li> `;
            }).join('');

            podContainer.innerHTML = ` <div class="mb-4"> <p class="text-sm font-bold uppercase tracking-wider text-slate-500">Selected POD Size: ${podSize} | Journey: Lvl ${currentLevel} ‚Üí Lvl ${targetLevel}</p> <h3 class="text-2xl font-bold text-purple-700">${baseCompositionData.category}</h3> </div> <div> <h4 class="text-lg font-semibold mb-3">Recommended Team Composition</h4> <ul class="space-y-1">${rolesHTML}</ul> </div>`;
            podContainer.classList.remove('opacity-0');
        }

        function updateMetricDetailsTable(currentLevel, targetLevel) {
            const detailsContainer = document.getElementById('metric-details-container');
            document.getElementById('target-level-display').textContent = `Level ${targetLevel}`;
            const tableContainer = document.getElementById('metric-details');
            let tableHTML = `<table class="min-w-full bg-white border border-slate-200"> <thead class="bg-slate-50"> <tr> <th class="py-3 px-4 text-left font-semibold text-slate-700 text-sm">SRE Metric</th>`;
            
            for(let i = 0; i <= targetLevel; i++) {
                let highlightClass = '';
                if (i === currentLevel) {
                    highlightClass = 'highlight-current';
                } else if (i === targetLevel) {
                    highlightClass = 'highlight-target';
                }
                tableHTML += `<th class="py-3 px-4 text-left font-semibold text-slate-700 text-sm ${highlightClass}">Level ${i}</th>`; 
            }
            tableHTML += `</tr></thead><tbody class="divide-y divide-slate-200">`;
            
            metrics.forEach(metric => { 
                tableHTML += `<tr><td class="py-3 px-4 font-medium text-sm text-slate-800">${metric}</td>`; 
                const criteria = metricCriteria[metric]; 
                for(let i = 0; i <= targetLevel; i++) { 
                    let highlightClass = '';
                     if (i === currentLevel) {
                        highlightClass = 'highlight-current';
                    } else if (i === targetLevel) {
                        highlightClass = 'highlight-target';
                    }
                    tableHTML += `<td class="py-3 px-4 text-sm text-slate-600 ${highlightClass}">${criteria[i] || 'N/A'}</td>`; 
                } 
                tableHTML += `</tr>`; 
            });
            tableHTML += `</tbody></table>`;
            tableContainer.innerHTML = tableHTML;
            detailsContainer.classList.remove('opacity-0');
        }

        function showLevelXRecommendations() {
            // This function is deprecated with the new 0-4 level system
        }

        // --- DASHBOARD ---
        function handleFileUpload(inputElement) {
            const file = inputElement.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    let json = XLSX.utils.sheet_to_json(worksheet);
                    
                    if(json.length > 0) {
                        const headers = Object.keys(json[0]).map(h => h.toLowerCase());
                        const requiredHeaders = ['project', 'team', 'podsize', 'metric', 'score'];
                        const hasRequiredHeaders = requiredHeaders.every(h => headers.includes(h));
                        if (!hasRequiredHeaders) {
                             alert(`Error: The sheet must contain the columns: Project, Team, PodSize, Metric, Score.`);
                             return;
                        }
                    } else {
                        alert('The data sheet is empty.');
                        return;
                    }
                    
                    json = json.map(row => {
                        const newRow = {};
                        for (const key in row) {
                            const lowerKey = key.toLowerCase();
                            if (lowerKey === 'project') newRow.Project = row[key];
                            else if (lowerKey === 'team') newRow.Team = row[key];
                            else if (lowerKey === 'podsize') newRow.PodSize = row[key];
                            else if (lowerKey === 'metric') newRow.Metric = row[key];
                            else if (lowerKey === 'score') newRow.Score = row[key];
                            else newRow[key] = row[key];
                        }
                        return newRow;
                    });

                    initializeApp(json);
                } catch(err) {
                    console.error("File parsing error:", err);
                    alert("There was an error processing the file. Please ensure it's a valid Excel or CSV file and matches the template.");
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function initDashboard() {
            initCharts();
            populateDashboardFilters();
            const projectSelect = document.getElementById('project-select');
            const teamSelect = document.getElementById('team-select');
            
            projectSelect.addEventListener('change', populateTeamFilter);
            teamSelect.addEventListener('change', updateDashboardVisuals);
            
            populateTeamFilter();
        }

        function populateDashboardFilters() {
            const projects = [...new Set(dashboardData.map(item => item.Project))];
            const projectSelect = document.getElementById('project-select');
            projectSelect.innerHTML = projects.map(p => `<option value="${p}">${p}</option>`).join('');
        }

        function populateTeamFilter() {
            const selectedProject = document.getElementById('project-select').value;
            const teams = [...new Set(dashboardData.filter(item => item.Project === selectedProject).map(item => item.Team))];
            const teamSelect = document.getElementById('team-select');
            teamSelect.innerHTML = teams.map(t => `<option value="${t}">${t}</option>`).join('');
            updateDashboardVisuals();
        }

        function updateDashboardVisuals() {
            const selectedProject = document.getElementById('project-select').value;
            const selectedTeam = document.getElementById('team-select').value;
            
            const projectData = dashboardData.filter(item => item.Project === selectedProject);
            const teamData = projectData.filter(item => item.Team === selectedTeam);
            
            renderHeatmap(projectData);
            updateCharts(teamData);
            updateAverageMaturityBadge(projectData);
        }
        
        function updateAverageMaturityBadge(projectData) {
            const container = document.getElementById('average-maturity-display');
            if (!projectData || projectData.length === 0) {
                container.innerHTML = '';
                return;
            }

            const totalScore = projectData.reduce((acc, item) => acc + item.Score, 0);
            const averageScore = Math.round(totalScore / projectData.length);
            const podSize = projectData[0]?.PodSize;

            const levelData = maturityLevelsData.find(l => l.level === averageScore);
            const colors = ['#9d4edd', '#7b2cbf', '#5a189a', '#3c096c', '#240046'];
            const color = averageScore >= 0 ? colors[averageScore] : '#E5E7EB';

            if(levelData) {
                 container.innerHTML = `
                    <div class="text-center">
                        <p class="text-sm font-medium text-slate-500 mb-1">Project Avg. Maturity</p>
                        <div class="inline-flex items-center justify-center p-2 rounded-full" style="background-color: ${color}20;">
                            <div class="w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl font-bold" style="background-color: ${color};">
                                ${levelData.icon}
                            </div>
                        </div>
                        <p class="font-bold text-slate-800 mt-1">Level ${levelData.level}: ${levelData.name}</p>
                    </div>
                 `;
            } else {
                 container.innerHTML = '';
            }
            
            document.querySelectorAll('.matrix-cell').forEach(c => c.classList.remove('calculated-average-highlight'));
            if(podSize && averageScore >= 0) {
                const targetCell = document.getElementById(`cell-${podSize}-${averageScore}`);
                if(targetCell) {
                    targetCell.classList.add('calculated-average-highlight');
                }
            }
        }


        function renderHeatmap(projectData) {
            const container = document.getElementById('heatmap-container');
            const teams = [...new Set(projectData.map(d => d.Team))];
            const projectMetrics = [...new Set(projectData.map(d => d.Metric))];
            const heatmapColors = ['#e9d5ff', '#c084fc', '#9333ea', '#6b21a8', '#3b0764'];

            let html = `<div class="heatmap-grid" style="grid-template-columns: 1fr repeat(${teams.length}, 1fr);">`;
            html += '<div class="font-bold text-sm text-slate-700 p-2 border-b border-r">Metric</div>';
            teams.forEach(team => {
                html += `<div class="font-bold text-sm text-slate-700 p-2 text-center border-b">${team}</div>`;
            });

            projectMetrics.forEach(metric => {
                html += `<div class="font-medium text-sm text-slate-600 p-2 border-r">${metric}</div>`;
                teams.forEach(team => {
                    const item = projectData.find(d => d.Team === team && d.Metric === metric);
                    const score = item ? item.Score : 0;
                    const color = score >= 0 ? heatmapColors[score] || '#E5E7EB' : '#F3F4F6';
                    html += `<div class="heatmap-cell" style="background-color: ${color};">${score}</div>`;
                });
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function initCharts() {
            const barCtx = document.getElementById('sre-kpi-chart').getContext('2d');
            sreChart = new Chart(barCtx, { type: 'bar', data: { labels:[], datasets:[]}, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 4 }, x: { ticks: { autoSkip: false, maxRotation: 45, minRotation: 45, font: { size: 10 } } } }, plugins: { legend: { position: 'top', }, title: { display: true, text: 'Current Maturity Scores', font: { size: 16 } } } } });
            const toilCtx = document.getElementById('toil-chart').getContext('2d');
            toilChart = new Chart(toilCtx, { type: 'doughnut', data: { labels:[], datasets:[]}, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Toil Reduction Progress', font: { size: 16 } } } } });
            const radarCtx = document.getElementById('maturity-radar-chart').getContext('2d');
            radarChart = new Chart(radarCtx, { type: 'radar', data: { labels:[], datasets:[]}, options: { responsive: true, maintainAspectRatio: false, scales: { r: { beginAtZero: true, max: 4, stepSize: 1, pointLabels: { font: { size: 9 } } } }, plugins: { legend: { display: false }, title: { display: true, text: 'SRE Maturity Profile', font: { size: 16 } } } } });
        }
        
        function updateCharts(teamData) {
            if (!sreChart || !toilChart || !radarChart || !teamData || teamData.length === 0) return;
            
            const selectedTeam = document.getElementById('team-select').value;
            const labels = teamData.map(d => d.Metric);
            const scores = teamData.map(d => d.Score);

            sreChart.options.plugins.title.text = `Current Maturity Scores (${selectedTeam})`;
            sreChart.data.labels = labels;
            sreChart.data.datasets = [{ label: 'Score', data: scores, backgroundColor: 'rgba(167, 139, 250, 0.6)', borderColor: 'rgba(139, 92, 246, 1)', borderWidth: 1, borderRadius: 4 }];
            sreChart.update();
            
            const toilScore = teamData.find(d => d.Metric === 'Toil Management')?.Score || 0;
            const automationPercentage = (toilScore / 4) * 100; 
            toilChart.data.labels = [`Automated (${automationPercentage.toFixed(0)}%)`, `Manual (${(100 - automationPercentage).toFixed(0)}%)`];
            toilChart.data.datasets = [{
                data: [automationPercentage, 100 - automationPercentage],
                backgroundColor: ['rgba(52, 211, 153, 0.7)', `rgba(244, 63, 94, 0.7)`],
                borderColor: ['rgba(16, 185, 129, 1)', `rgba(225, 29, 72, 1)`],
                borderWidth: 1
            }];
            toilChart.update();

            radarChart.data.labels = metrics.map(m => m.replace(/ & | /g, '\n'));
            const radarScores = metrics.map(metric => teamData.find(d => d.Metric === metric)?.Score || 0);
            radarChart.data.datasets[0] = {
                label: 'Current Maturity Profile',
                data: radarScores,
                fill: true,
                backgroundColor: 'rgba(139, 92, 246, 0.2)',
                borderColor: 'rgba(139, 92, 246, 1)',
                pointBackgroundColor: 'rgba(139, 92, 246, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(139, 92, 246, 1)'
            };
            radarChart.update();
        }


        function initIntroAnimation() {
            const playButton = document.getElementById('play-animation-btn');
            playButton.dataset.status = 'stopped';
            const synth = window.speechSynthesis;
            let utterance = null;
            let currentStep = 0;

            const animationScript = [
                { text: "This matrix visualizes the effort and progression needed to uplift different project sizes, from extra-small to extra-large, through the SRE Framework maturity stages ‚Äî from Level 0 (Grounded) to Level 4 (Intelligent Plus).", highlights: [] },
                { text: "The Y-axis shows POD sizes. As you go up, the scope and complexity of the project increases.", highlights: ['intro-pod-size-label-1', 'intro-pod-size-label-2', 'intro-pod-size-label-3', 'intro-pod-size-label-4', 'intro-pod-size-label-5'] },
                { text: "The X-axis represents maturity levels. Each level requires more advanced capabilities.", highlights: ['intro-level-label-0', 'intro-level-label-1', 'intro-level-label-2', 'intro-level-label-3', 'intro-level-label-4'] },
                { text: "The shaded cells show a project's current position and its target. For instance, a large project might currently be at level 2, aiming for level 4.", highlights: ['intro-cell-2-4', 'intro-cell-4-4'] },
                { text: "The dashed lines illustrate the uplift journey. Notice how they trace the path from a team‚Äôs current level to their goal.", highlights: [], path: { id: 'all' } },
                { text: "The color intensity deepens as you move to the right, symbolizing the increased resources, time, and skills needed for higher levels.", highlights: ['intro-cell-0-4', 'intro-cell-1-4', 'intro-cell-2-4', 'intro-cell-3-4', 'intro-cell-4-4'] },
                { text: "Finally, the timeline bar at the bottom shows that larger pods generally take longer to advance through each level.", highlights: [] },
                { text: "And that's a quick tour of the PODs Maturity Matrix.", highlights: [] }
            ];

            function runAnimationStep() {
                if (currentStep >= animationScript.length) {
                    playButton.innerText = "‚ñ∂ Replay PODs Animation";
                    playButton.dataset.status = 'stopped';
                    currentStep = 0;
                    document.querySelectorAll('.intro-highlight-cell, .visible').forEach(el => el.classList.remove('intro-highlight-cell', 'visible'));
                    return;
                }
                document.querySelectorAll('.intro-highlight-cell, .visible').forEach(el => el.classList.remove('intro-highlight-cell', 'visible'));
                const step = animationScript[currentStep];
                utterance = new SpeechSynthesisUtterance(step.text);
                utterance.rate = 0.9; 
                utterance.pitch = 1.0; 
                utterance.onstart = () => {
                    step.highlights.forEach(id => { const el = document.getElementById(id); if (el) {el.classList.add('intro-highlight-cell');} });
                    if (step.path && step.path.id === 'all') {
                        document.querySelectorAll('.intro-uplift-path, .intro-path-dot').forEach(el => el.classList.add('visible'));
                    }
                };
                utterance.onend = () => {
                    if(playButton.dataset.status === 'playing') {
                        step.highlights.forEach(id => { const el = document.getElementById(id); if (el) {el.classList.remove('intro-highlight-cell');} });
                        currentStep++;
                        runAnimationStep();
                    }
                };
                synth.speak(utterance);
            }

            playButton.addEventListener('click', () => {
                 if (synth.speaking) { synth.cancel(); }
                 
                if (playButton.dataset.status === 'playing') {
                    playButton.dataset.status = 'stopped';
                    playButton.innerText = "‚ñ∂ Play PODs Animation";
                } else if (playButton.dataset.status === 'paused') {
                    playButton.dataset.status = 'playing';
                    playButton.innerText = "‚ùö‚ùö Stop Animation";
                    synth.resume();
                } else {
                    currentStep = 0;
                    playButton.dataset.status = 'playing';
                    playButton.innerText = "‚ùö‚ùö Stop Animation";
                    setTimeout(runAnimationStep, 100);
                }
            });

            function drawIntroPaths() {
                const paths = [
                    { id: 'path1', from: 'intro-cell-1-1', to: 'intro-cell-4-1' }, { id: 'path2', from: 'intro-cell-1-2', to: 'intro-cell-4-2' },
                    { id: 'path3', from: 'intro-cell-2-3', to: 'intro-cell-4-3' }, { id: 'path4', from: 'intro-cell-3-4', to: 'intro-cell-4-5' },
                ];
                const dotsContainer = document.getElementById('dots-container');
                dotsContainer.innerHTML = ''; 
                paths.forEach(p => {
                    const fromEl = document.getElementById(p.from); const toEl = document.getElementById(p.to); const pathEl = document.getElementById(p.id);
                    if (fromEl && toEl && pathEl) {
                        const startX = fromEl.offsetLeft + fromEl.offsetWidth / 2; const startY = fromEl.offsetTop + fromEl.offsetHeight / 2;
                        const endX = toEl.offsetLeft + toEl.offsetWidth / 2; const endY = toEl.offsetTop + toEl.offsetHeight / 2;
                        const pathData = `M ${startX},${startY} L ${startX},${endY} L ${endX},${endY}`;
                        pathEl.setAttribute('d', pathData);
                        ['from', 'to'].forEach(point => {
                            const dot = document.createElement('div');
                            dot.className = 'intro-path-dot';
                            dot.style.left = point === 'from' ? `${startX}px` : `${endX}px`;
                            dot.style.top = point === 'from' ? `${startY}px` : `${endY}px`;
                            dot.id = `dot-${p[point]}`;
                            dotsContainer.appendChild(dot);
                        });
                    }
                });
            }
            setTimeout(drawIntroPaths, 100);
            window.addEventListener('resize', () => setTimeout(drawIntroPaths, 100));
        }

        function populateLevelsExplainer() {
            const container = document.getElementById('levels-infographic-container');
            if(!container) return;
            container.innerHTML = '';
            const headerColors = ['#9d4edd', '#7b2cbf', '#5a189a', '#3c096c', '#240046'];
            
            const introCard = document.createElement('div');
            introCard.className = "level-card rounded-lg bg-slate-100 flex flex-col justify-center items-center p-6";
            introCard.innerHTML = `<h3 class="text-2xl font-bold text-slate-800 text-center">Our Maturity Levels</h3><p class="text-slate-600 text-center mt-2">A five-stage journey from manual operations to autonomous resilience.</p>`;
            container.appendChild(introCard);

            maturityLevelsData.filter(l => l.level !== 'X').forEach((level, index) => {
                const card = document.createElement('div');
                card.className = 'level-card rounded-lg bg-white shadow-md flex flex-col';
                card.style.borderColor = headerColors[index];

                card.innerHTML = `
                    <div class="p-4 rounded-t-lg" style="background-color: ${headerColors[index]}">
                        <h3 class="text-xl font-bold text-white text-center">Level ${level.level}: ${level.name}</h3>
                    </div>
                    <div class="p-6 flex-grow">
                        <p class="text-5xl text-center mb-4">${level.icon}</p>
                        <div class="mb-4">
                            <h4 class="font-bold text-slate-800">Description</h4>
                            <p class="text-slate-600 text-sm">${level.desc}</p>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-800">Analogy</h4>
                            <p class="text-slate-600 text-sm">${level.analogy}</p>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
    </script>
</body>
</html>
ÔøΩ
