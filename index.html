<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G.E.N.A.I.X. SRE Maturity Framework SPA</title>
    <!-- Chosen Palette: Slate & Purple -->
    <!-- Application Structure Plan: A single-page dashboard designed for guided exploration. The structure flows from high-level concepts to interactive tools and detailed information. 1. Intro to the Framework: Sets the stage. 2. Interactive Maturity Explorer: The core of the app, allowing users to select a current and target maturity to visualize the required effort. This immediately connects a user's context to the specific requirements. 3. Dynamic Recommendations: POD sizing and team composition update based on the explorer selection, providing instant, relevant guidance. 4. Implementation Lifecycle: A visual process flow to clarify the 'how-to'. 5. Dashboard Simulation: A concrete example of the framework's output using a Chart.js visualization. This structure was chosen to transform the static PDF into a goal-oriented tool, where users can quickly find information relevant to their specific situation (team size, goals) rather than reading linearly. -->
    <!-- Visualization & Content Choices: 1. Maturity Levels (Inform) -> Cards with icons (HTML/CSS) for a clear visual overview. 2. Maturity Matrix (Explore/Relate) -> Interactive HTML grid with JS-powered path animation on a canvas overlay. Replaces static image for user engagement and planning. 3. SRE Metrics (Compare/Inform) -> A dynamic table generated by JS, filtered by the target selection. 4. POD Composition (Inform) -> Cleanly styled cards that update dynamically. 5. Lifecycle (Organize/Inform) -> An HTML/CSS process flow diagram. 6. Dashboard (Compare) -> Chart.js bar chart for a professional, interactive data visualization of KPIs. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; height: 400px; max-height: 50vh; }
        .small-chart-container { position: relative; width: 100%; max-width: 400px; margin-left: auto; margin-right: auto; height: 350px; max-height: 45vh; }
        @media (min-width: 768px) { .chart-container { height: 450px; } }
        .nav-link { transition: color 0.3s; }
        .nav-link:hover { color: #8b5cf6; }
        
        #maturity-matrix-grid {
            display: grid;
            grid-template-columns: 6rem repeat(5, 1fr);
            gap: 0.5rem;
        }

        .matrix-cell { 
            transition: all 0.2s ease-in-out;
            aspect-ratio: 1 / 1;
        }
        .matrix-cell.selectable:hover { 
            transform: scale(1.1); 
            z-index: 10; 
            box-shadow: 0 0 15px rgba(167, 139, 250, 0.7);
            border-color: #a78bfa;
        }
        .matrix-cell.current-selection { background-color: #fbbf24 !important; color: #78350f; border: 2px solid #f59e0b; }
        .matrix-cell.target-selection { background-color: #6d28d9 !important; color: white; border: 2px solid #a78bfa; }
        .matrix-cell.disabled { cursor: not-allowed; filter: grayscale(80%) opacity(50%); }
        .matrix-cell.recommended-target {
            animation: pulse-glow 2s infinite;
        }
        .matrix-cell.calculated-average-highlight {
            animation: pulse-border 2s infinite;
            border: 3px solid #10B981;
        }
        
        @keyframes pulse-glow {
            0% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
            100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0); }
        }

        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(16, 185, 129, 0); }
            100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        #path-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
        }

        .step-item { flex: 1; }
        .step-item:not(:last-child)::after { content: '→'; color: #a78bfa; font-size: 1.5rem; font-weight: bold; position: absolute; right: -20px; top: 50%; transform: translateY(-50%); }
    
        .highlight-current { background-color: rgba(251, 191, 36, 0.2) !important; }
        .highlight-target { background-color: rgba(167, 139, 250, 0.2) !important; }

        /* Styles for Animated Intro */
        .intro-matrix-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 4px;
            position: relative;
        }
        .intro-grid-cell {
            border-radius: 8px;
            transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .intro-header-cell, .intro-label-cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            text-align: center;
            border-radius: 8px;
            color: white;
        }
        .intro-pod-size-label {
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            background-color: #7c3aed;
        }
        .intro-level-label {
             background-color: #9d4edd;
        }

        .intro-highlight-cell {
            transform: scale(1.08) translateZ(20px);
            box-shadow: 0 0 30px rgba(167, 139, 250, 0.7);
            z-index: 10;
            border: 2px solid rgba(139, 92, 246, 0.9);
        }
        .intro-uplift-path {
            position: absolute;
            stroke: #4f46e5;
            stroke-width: 3px;
            stroke-dasharray: 8 8;
            fill: none;
            opacity: 0;
            stroke-dashoffset: 1000;
            transition: opacity 0.5s ease-in-out, stroke-dashoffset 2.5s ease-in-out;
        }
        .intro-uplift-path.visible {
            opacity: 0.8;
            stroke-dashoffset: 0;
        }
        .intro-path-dot {
             position: absolute;
             width: 16px;
             height: 16px;
             background-color: #4f46e5;
             border-radius: 50%;
             transform: translate(-50%, -50%);
             opacity: 0;
             transition: opacity 0.5s ease-in-out 0.5s;
             box-shadow: 0 0 10px #4f46e5;
        }
        .intro-path-dot.visible {
             opacity: 1;
        }
        .intro-header-guiding { background-color: #9d4edd; }
        .intro-header-explore { background-color: #7b2cbf; }
        .intro-header-normalize { background-color: #5a189a; }
        .intro-header-adapt { background-color: #3c096c; }
        .intro-header-intelligent { background-color: #240046; }
        
        .intro-grid-cell[data-level='1'] { background-color: rgba(157, 78, 221, 0.4); }
        .intro-grid-cell[data-level='2'] { background-color: rgba(123, 44, 191, 0.5); }
        .intro-grid-cell[data-level='3'] { background-color: rgba(90, 24, 154, 0.6); }
        .intro-grid-cell[data-level='4'] { background-color: rgba(60, 9, 108, 0.7); }
        .intro-grid-cell[data-level='5'] { background-color: rgba(36, 0, 70, 0.8); }
        
        .intro-timeline-bar {
             background: linear-gradient(to right, #9d4edd, #7b2cbf, #5a189a, #3c096c, #240046);
        }

        .play-button {
            transition: all 0.3s ease;
        }
        .play-button:disabled {
            cursor: not-allowed;
            background-color: #6b7280;
            opacity: 0.5;
        }
        
        /* Levels Explainer Styles */
        .level-card {
            transition: all 0.3s ease-in-out;
            border-width: 2px;
            border-color: transparent;
        }
        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border-color: currentColor;
        }
        
        /* Heatmap Styles */
        .heatmap-grid {
            display: grid;
            gap: 4px;
        }
        .heatmap-cell {
            padding: 0.5rem;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            min-height: 50px;
        }

    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body class="bg-slate-50 text-slate-800">

    <div id="upload-overlay" class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center transition-opacity duration-500">
        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-lg w-full text-center transform transition-all duration-500 scale-95 opacity-0" id="upload-card">
            <h2 class="text-3xl font-extrabold text-slate-900 mb-2">Welcome to the SRE Maturity App</h2>
            <p class="text-slate-600 mb-6">To power the performance dashboard, please upload an Excel file.</p>
            <div class="bg-slate-50 border border-slate-200 rounded-lg p-4 text-left text-sm mb-6">
                <p class="font-semibold mb-2">Excel File Requirements:</p>
                <ul class="list-disc list-inside text-slate-600 space-y-1">
                    <li>A sheet named <strong class="text-purple-600">DashboardData</strong>.</li>
                    <li>Columns: <strong class="text-purple-600">Project, Team, PodSize, Metric, Score</strong>.</li>
                </ul>
                <a href="data:text/csv;charset=utf-8,Project,Team,PodSize,Metric,Score%0ACapability,Dev%20Team,M,Toil%20Management,3%0ACapability,Dev%20Team,M,Incident%20Response,2%0ACapability,Dev%20Team,M,Observability%20&%20Monitoring,2%0ACapability,Dev%20Team,M,SLOS%20/%20SLIs,1%0ACapability,Dev%20Team,M,Learning%20Reviews,3%0ACapability,Dev%20Team,M,Knowledge%20Systems,2%0ACapability,Dev%20Team,M,Tooling,2%0ACapability,Dev%20Team,M,Chaos%20Engineering,1%0ACapability,Test%20Team,S,Toil%20Management,4%0ACapability,Test%20Team,S,Incident%20Response,4%0ACapability,Test%20Team,S,Observability%20&%20Monitoring,3%0ACapability,Test%20Team,S,SLOS%20/%20SLIs,2%0ACapability,Test%20Team,S,Learning%20Reviews,4%0ACapability,Test%20Team,S,Knowledge%20Systems,3%0ACapability,Test%20Team,S,Tooling,3%0ACapability,Test%20Team,S,Chaos%20Engineering,2" download="SRE_Dashboard_Template.csv" class="text-purple-600 hover:underline mt-2 inline-block">Download Sample Template (.csv)</a>
            </div>
            <input type="file" id="excel-upload-input" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100 mb-4" accept=".xlsx, .xls, .csv">
            <button id="process-file-btn" class="w-full bg-purple-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-purple-700 transition duration-300 disabled:bg-slate-400 disabled:cursor-not-allowed" disabled>Process File</button>
            <button id="continue-sample-btn" class="w-full bg-slate-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-slate-700 transition duration-300 mt-2">Continue with Sample Data</button>
        </div>
    </div>

    <div id="main-content" class="opacity-0 transition-opacity duration-500">
        <header class="bg-slate-900/80 backdrop-blur-sm text-white sticky top-0 z-40 shadow-md">
            <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
                <h1 class="text-xl md:text-2xl font-bold text-white">G.E.N.A.I.X. Framework</h1>
                <div class="hidden md:flex items-center space-x-6 text-sm font-medium">
                    <a href="#framework" class="nav-link">Framework</a>
                    <a href="#dashboard" class="nav-link">Dashboard</a>
                    <a href="#maturity-levels-explainer" class="nav-link">Maturity Levels</a>
                    <a href="#maturity-intro" class="nav-link">Maturity Matrix</a>
                    <a href="#explorer" class="nav-link">Explorer</a>
                    <a href="#recommendations" class="nav-link">Recommendations</a>
                    <a href="#lifecycle" class="nav-link">Lifecycle</a>
                </div>
                <button id="mobile-menu-button" class="md-hidden focus:outline-none">
                    <span class="text-3xl">≡</span>
                </button>
            </nav>
            <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 space-y-2">
                <a href="#framework" class="block nav-link">Framework</a>
                <a href="#dashboard" class="block nav-link">Dashboard</a>
                <a href="#maturity-levels-explainer" class="block nav-link">Maturity Levels</a>
                <a href="#maturity-intro" class="block nav-link">Maturity Matrix</a>
                <a href="#explorer" class="block nav-link">Explorer</a>
                <a href="#recommendations" class="block nav-link">Recommendations</a>
                <a href="#lifecycle" class="block nav-link">Lifecycle</a>
            </div>
        </header>

        <main class="container mx-auto p-4 md:p-8">
            
            <section id="framework" class="mb-16 scroll-mt-24">
                <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">The G.E.N.A.I.X. Maturity Framework</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mx-auto">An evolutionary roadmap to transform operations from manual processes to GenAI-enabled, autonomous resilience.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Maturity Levels will be injected here by JS -->
                </div>
            </section>

            <section id="dashboard" class="mb-16 scroll-mt-24">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">Performance Dashboard</h2>
                    <p class="text-md text-slate-600 max-w-2xl mx-auto">This dashboard visualizes the maturity data from the uploaded file. Use the dropdowns to explore different projects and teams.</p>
                </div>
                <div class="bg-white p-6 md:p-8 rounded-2xl shadow-lg">
                     <div class="flex flex-col md:flex-row gap-4 mb-8 items-center">
                        <div class="flex-1">
                            <label for="project-select" class="block text-sm font-medium text-slate-700 mb-1">Select a Project:</label>
                            <select id="project-select" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm"></select>
                        </div>
                         <div class="flex-1">
                            <label for="team-select" class="block text-sm font-medium text-slate-700 mb-1">Select a Team:</label>
                            <select id="team-select" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 sm:text-sm"></select>
                        </div>
                         <div id="average-maturity-display" class="flex-1 text-center">
                             <!-- Average maturity badge will be injected here -->
                         </div>
                        <div class="flex items-end">
                             <button id="reupload-btn" class="bg-slate-200 text-slate-700 text-sm font-bold py-2 px-4 rounded-md hover:bg-slate-300 transition h-10">Upload New Data</button>
                        </div>
                    </div>

                    <div id="dashboard-content">
                         <div class="mb-12">
                            <h3 class="text-2xl font-bold text-center mb-6 text-slate-800">Maturity Level Heatmap</h3>
                            <div id="heatmap-container" class="overflow-x-auto"></div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-center">
                            <div class="lg:col-span-2">
                                <div class="chart-container">
                                    <canvas id="sre-kpi-chart"></canvas>
                                </div>
                            </div>
                            <div>
                                <div class="small-chart-container">
                                    <canvas id="toil-chart"></canvas>
                                </div>
                            </div>
                             <div>
                                <div class="small-chart-container">
                                     <canvas id="maturity-radar-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="maturity-levels-explainer" class="mb-16 bg-white p-6 md:p-8 rounded-2xl shadow-lg scroll-mt-24">
                 <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">Maturity Levels Explained</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mx-auto">Hover over a card to learn more about each maturity level.</p>
                </div>
                <div class="grid xl:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-6" id="levels-infographic-container">
                    <!-- Infographic cards will be generated here -->
                </div>
            </section>

            <section id="maturity-intro" class="mb-16 bg-white p-6 md:p-8 rounded-2xl shadow-lg scroll-mt-24">
                <div class="w-full max-w-4xl mx-auto">
                    <h2 class="text-4xl font-bold text-center mb-8 text-slate-900">PODs Matrix Explained</h2>
                    <div class="relative">
                        <div class="intro-matrix-grid" id="intro-matrix-grid">
                            <div class="intro-header-cell"></div>
                            <div class="intro-header-cell intro-header-guiding">GUIDING</div>
                            <div class="intro-header-cell intro-header-explore">EXPLORE</div>
                            <div class="intro-header-cell intro-header-normalize">NORMALIZE</div>
                            <div class="intro-header-cell intro-header-adapt">ADAPT</div>
                            <div class="intro-header-cell intro-header-intelligent">INTELLIGENT</div>

                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-5">Extra-large</div>
                            <div class="intro-grid-cell" id="intro-cell-1-5" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-5" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-5" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-5" data-level="4"></div><div class="intro-grid-cell" id="intro-cell-5-5" data-level="5"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-4">Large</div>
                            <div class="intro-grid-cell" id="intro-cell-1-4" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-4" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-4" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-4" data-level="4"></div><div class="intro-grid-cell" id="intro-cell-5-4" data-level="5"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-3">Medium</div>
                            <div class="intro-grid-cell" id="intro-cell-1-3" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-3" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-3" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-3" data-level="4"></div><div class="intro-grid-cell" id="intro-cell-5-3" data-level="5"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-2">Small</div>
                            <div class="intro-grid-cell" id="intro-cell-1-2" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-2" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-2" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-2" data-level="4"></div><div class="intro-grid-cell" id="intro-cell-5-2" data-level="5"></div>
                            <div class="intro-label-cell intro-pod-size-label" id="intro-pod-size-label-1">XS</div>
                            <div class="intro-grid-cell" id="intro-cell-1-1" data-level="1"></div><div class="intro-grid-cell" id="intro-cell-2-1" data-level="2"></div><div class="intro-grid-cell" id="intro-cell-3-1" data-level="3"></div><div class="intro-grid-cell" id="intro-cell-4-1" data-level="4"></div><div class="intro-grid-cell" id="intro-cell-5-1" data-level="5"></div>

                            <div class="intro-label-cell text-slate-700">POD SIZES</div>
                            <div class="intro-label-cell intro-level-label" id="intro-level-label-1">Level 1</div><div class="intro-label-cell intro-level-label" id="intro-level-label-2">Level 2</div><div class="intro-label-cell intro-level-label" id="intro-level-label-3">Level 3</div><div class="intro-label-cell intro-level-label" id="intro-level-label-4">Level 4</div><div class="intro-label-cell intro-level-label" id="intro-level-label-5">Level 5</div>
                        </div>

                        <svg id="uplift-svg" width="100%" height="100%" style="position: absolute; top: 0; left: 0; pointer-events: none;">
                            <path id="path1" d="" class="intro-uplift-path"/><path id="path2" d="" class="intro-uplift-path"/><path id="path3" d="" class="intro-uplift-path"/><path id="path4" d="" class="intro-uplift-path"/>
                        </svg>
                        <div id="dots-container" style="position: absolute; top: 0; left: 0; width:100%; height:100%; pointer-events: none;"></div>
                    </div>

                    <div class="mt-4 text-center">
                        <div class="inline-block w-full h-4 rounded-full intro-timeline-bar"></div>
                        <p class="text-sm text-slate-600 mt-2">Shortest timeline <span class="mx-4"> &harr; </span> Longest timeline per level</p>
                    </div>
                    <div class="text-center mt-8">
                        <button id="play-animation-btn" class="play-button bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full shadow-lg text-xl focus:outline-none focus:ring-4 focus:ring-purple-300">
                            ▶ Play PODs Animation
                        </button>
                    </div>
                </div>
            </section>


            <section id="explorer" class="mb-16 bg-white p-6 md:p-8 rounded-2xl shadow-lg scroll-mt-24">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-900 mb-2">Interactive Maturity Explorer</h2>
                    <p class="text-md text-slate-600 max-w-3xl mx-auto">Select your team's current maturity, then its target. The tool will visualize the uplift path and generate tailored recommendations.</p>
                </div>

                <div class="flex flex-col md:flex-row items-center justify-center gap-4 mb-6">
                     <p id="selection-prompt" class="text-lg font-semibold text-purple-700">Select your CURRENT maturity</p>
                     <button id="reset-selection-btn" class="bg-slate-200 text-slate-700 text-sm font-bold py-2 px-4 rounded-full hover:bg-slate-300 transition hidden">Reset Selection</button>
                </div>
                
                <div id="maturity-matrix-container" class="relative max-w-3xl mx-auto">
                     <div id="maturity-matrix-grid">
                        <!-- Matrix cells will be injected here -->
                     </div>
                     <canvas id="path-canvas"></canvas>
                </div>

                <div id="metric-details-container" class="mt-12 opacity-0 transition-opacity duration-500">
                    <h3 class="text-2xl font-bold text-center mb-6">Metric Requirements for Target: <span id="target-level-display" class="text-purple-600"></span></h3>
                    <div id="metric-details" class="overflow-x-auto">
                        <!-- Metric details table will be injected here -->
                    </div>
                </div>
            </section>

            <section id="recommendations" class="mb-16 scroll-mt-24">
                 <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-900">Team Size Recommendations</h2>
                    <p class="text-md text-slate-600 max-w-2xl mx-auto">Based on your target selection in the explorer, here is the recommended POD structure and team composition.</p>
                </div>
                <div id="pod-recommendation-container" class="bg-white p-8 rounded-2xl shadow-lg transition-all duration-500 ease-in-out opacity-0">
                    <!-- POD recommendation will be injected here -->
                </div>
            </section>

            <section id="lifecycle" class="mb-16 scroll-mt-24">
                 <div class="text-center mb-12">
                    <h2 class="text-4xl font-extrabold text-slate-900 mb-2">The Transformation Lifecycle</h2>
                    <p class="text-lg text-slate-600 max-w-3xl mx-auto">Follow this 6-step roadmap to implement the G.E.N.A.I.X. framework, moving from initial assessment to certified maturity.</p>
                </div>
                <div id="lifecycle-steps" class="flex flex-col md:flex-row items-stretch justify-center gap-y-8 md:gap-x-12 relative">
                    <!-- Lifecycle steps will be injected here -->
                </div>
            </section>
        </main>

        <footer class="bg-slate-800 text-slate-400 mt-16 py-8">
            <div class="container mx-auto px-6 text-center text-sm">
                <p>&copy; 2025 ATCP SRE Automation Maturity Framework. All data derived from the source report.</p>
                <p class="mt-2">This is an interactive visualization for educational and assessment purposes.</p>
            </div>
        </footer>
    </div>
    <script>
        const maturityLevelsData = [ { level: 1, name: 'GUIDING', desc: 'Reactive, with manual ad hoc processes and high toil.', icon: '🔥', analogy: "Think of a firefighter. They react when the alarm sounds, putting out fires manually. There's no prevention, only damage control." }, { level: 2, name: 'EXPLORE', desc: 'Exploratory and structured, guided by scripts and SOPs.', icon: '🛠️', analogy: "This is like a technician. They have a toolkit and standard procedures. They follow checklists and fix issues faster, but still react to problems after they happen." }, { level: 3, name: 'NORMALIZE', desc: 'Insight-driven, using observability and structured postmortems.', icon: '🩺', analogy: "Here, we have the diagnostician. They recognize recurring symptoms and use patterns to understand root causes, shifting from just fixing to thinking." }, { level: 4, name: 'ADAPT', desc: 'Proactive, with feedback loops and AI-assisted failure prediction.', icon: '🔮', analogy: "Like a weather forecaster, this level analyzes trends and warns before problems occur. It uses data and models to guide proactive action, learning and adapting over time." }, { level: 5, name: 'INTELLIGENT', desc: 'Agentic, where GenAI promotes proactive resilience and learning.', icon: '🤖', analogy: "Imagine a self-driving system. GenAI agents act, resolve, and optimize operations autonomously with minimal human input." }, { level: 'X', name: 'X-FORM', desc: 'A next-level, emergent AI ecosystem.', icon: '🌌', analogy: "This is the ultimate goal: an AI-to-AI ecosystem. Systems here evolve on their own, generating new agents and redesigning processes with no human instruction." } ];
        const podSizes = ['XL', 'L', 'M', 'S', 'XS'];
        const levels = [1, 2, 3, 4, 5];
        
        const podDataMatrix = {
             'XS': {
                2: { category: 'Foundational', roles: { 'SRE Analyst': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 20 }, 'App SME': { count: 1, alloc: 20 } } },
                3: { category: 'Foundational', roles: { 'SRE Analyst': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 20 }, 'PM': { count: 1, alloc: 20 }, 'App SME': { count: 1, alloc: 20 } } },
                4: { category: 'Foundational', roles: { 'SRE Analyst': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 50 }, 'PM': { count: 1, alloc: 50 }, 'App SME': { count: 1, alloc: 30 } } },
                5: { category: 'Foundational', roles: { 'SRE Analysts': { count: 2, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 50 }, 'PM': { count: 1, alloc: 50 }, 'App SME': { count: 1, alloc: 30 } } }
            },
            'S': {
                3: { category: 'Foundational', roles: { 'SRE Analysts': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 50 }, 'PM': { count: 1, alloc: 50 }, 'App SME': { count: 1, alloc: 30 } } },
                4: { category: 'Foundational', roles: { 'SRE Analysts': { count: 2, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 50 }, 'PM': { count: 1, alloc: 70 }, 'App SME': { count: 1, alloc: 50 } } },
                5: { category: 'Growth', roles: { 'SRE Analysts': { count: 2, alloc: 100 }, 'SRE Ambassador': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'GenAI Ambassador': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 100 } } }
            },
            'M': {
                3: { category: 'Growth', roles: { 'SRE Analyst': { count: 1, alloc: 100 }, 'SRE Ambassador': { count: 1, alloc: 100 }, 'Data Analyst': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 70 }, 'Tooling / Application SME': { count: 1, alloc: 80 } } },
                4: { category: 'Growth', roles: { 'SRE Analysts': { count: 2, alloc: 100 }, 'SRE Ambassador': { count: 1, alloc: 100 }, 'Data Analyst': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineer': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Tooling / Application SME': { count: 1, alloc: 80 } } },
                5: { category: 'Growth', roles: { 'SRE Analysts': { count: 3, alloc: 100 }, 'SRE Ambassador': { count: 1, alloc: 100 }, 'Data Analyst': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineers': { count: 2, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Tooling / Application SME': { count: 1, alloc: 100 } } }
            },
            'L': {
                4: { category: 'Strategic', roles: { 'SRE Analysts': { count: 2, alloc: 100 }, 'SRE Ambassador': { count: 1, alloc: 100 }, 'Data Analysts': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineers': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Tooling / App SME': { count: 1, alloc: 80 } } },
                5: { category: 'Strategic', roles: { 'SRE Analysts': { count: 4, alloc: 100 }, 'SRE Ambassador': { count: 1, alloc: 100 }, 'Data Analysts': { count: 1, alloc: 100 }, 'RPA Engineer': { count: 1, alloc: 100 }, 'Prompt Engineers': { count: 2, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Tooling / App SME': { count: 1, alloc: 80 } } }
            },
            'XL': {
                4: { category: 'Strategic', roles: { 'Transformation Leads': { count: 1, alloc: 100 }, 'SRE Ambassadors': { count: 1, alloc: 100 }, 'SRE Analysts': { count: 3, alloc: 100 }, 'Data Analysts': { count: 1, alloc: 100 }, 'RPA Engineers': { count: 1, alloc: 100 }, 'Prompt Engineers': { count: 1, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Application SMEs': { count: 1, alloc: 100 } } },
                5: { category: 'Strategic', roles: { 'Transformation Leads': { count: 1, alloc: 100 }, 'SRE Ambassadors': { count: 2, alloc: 100 }, 'SRE Analysts': { count: 4, alloc: 100 }, 'Data Analysts': { count: 2, alloc: 100 }, 'RPA Engineers': { count: 2, alloc: 100 }, 'Prompt Engineers': { count: 2, alloc: 100 }, 'PM': { count: 1, alloc: 100 }, 'Application SMEs': { count: 2, alloc: 100 } } }
            }
        };

        const metrics = [ "Toil Management", "Incident Response", "Observability & Monitoring", "SLOS / SLIs", "Learning Reviews", "Knowledge Systems", "Tooling", "Chaos Engineering" ];
        const metricCriteria = { 
            "Toil Management": ["<10% automation", "10-30% automation", "30-50% automation", ">70% automated toil", ">90% toil resolved by agents", "100% zero-touch ops, self-generative"], 
            "Incident Response": ["No measurement", "Basic logging, ad hoc MTTR", "MTTR reduction 10-30%", "MTTR 40-60%", "MTTR >70%, GenAl triage/autofix", "Zero-downtime via predictive, autonomous agents"], 
            "Observability & Monitoring": ["Alerts only, no telemetry", "Threshold-based dashboards", "Anomaly detection active", "≥80% actionable alerts, ≥60% predictive acc.", "Auto-tuned alerts, telemetry learns patterns", "RCA written by telemetry, 100% prediction accuracy"], 
            "SLOS / SLIs": ["No tracking", "Basic dashboards", "SLIS/SLOS tracked, some reporting", "<=1x error budget burn per week", "Policy-based SLO enforcement", "Al enforces, optimizes and redesigns error budgets"], 
            "Learning Reviews": ["Rare or no PMs", "Templates used occasionally", "PMs drive follow-up actions", "≥90% incidents with PMs", "PMs auto-summarized by GenAl", "AI-to-AI PM loops, fully reflexive feedback system"], 
            "Knowledge Systems": ["Static, tribal knowledge", "Tagged SOPs and wikis", "Searchable KBs", "≥70% reuse, ≥90% search accuracy", "GenAl suggests and evolves KB content", "KB self-generates, refines from live operations"], 
            "Tooling": ["Disconnected scripts/tools", "Basic CI/CD", "CI/CD with monitoring integrations", ">75% tool consolidation", "Self-tuning infra via GenAl agents", "GenAl agents deploy and manage other agents"], 
            "Chaos Engineering": ["No practice", "Manual game days", "Fault injection tooling in place", "≥80% auto-recovery during chaos tests", "AI-informed chaos tuning and simulation", "Al runs, breaks, and heals infrastructure"] 
        };
        const lifecycleData = [ { step: 1, name: "Maturity Assessment", action: "Evaluate current state of project/team using the G.E.N.A.I.X. model.", output: "Maturity level per metrics (e.g., Toil=2, SLOs=3)"}, { step: 2, name: "Tool Inventory", action: "Identify existing tools used by the team.", output: "Capability-to-tool matrix showing gaps or overlaps"}, { step: 3, name: "Gap Analysis", action: "Engage SMEs for deeper understanding of tool usage, pain points, and blockers.", output: "Gap report + capability roadmap per team"}, { step: 4, name: "Target Definition", action: "Define the target maturity level per team/project.", output: "Capability heatmap per team/project showing current and target levels"}, { step: 5, name: "Transformation Plan", action: "Co-create action plans for each metric to move from current → target.", output: "Roadmap with initiatives, tools/skills needed, timeline, and KPIs"}, { step: 6, name: "Certification", action: "Achieve SRE Ambassador Certification (Maturity Badge Tagging).", output: "X-Form Readiness Identification if team hits Level 5"} ];
        
        const sampleDashboardData = [
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Toil Management", "Score": 3 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Incident Response", "Score": 2 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Observability & Monitoring", "Score": 2 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "SLOS / SLIs", "Score": 1 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Learning Reviews", "Score": 3 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Knowledge Systems", "Score": 2 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Tooling", "Score": 2 },
            { "Project": "Capability", "Team": "Dev Team", "PodSize": "M", "Metric": "Chaos Engineering", "Score": 1 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Toil Management", "Score": 4 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Incident Response", "Score": 4 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Observability & Monitoring", "Score": 3 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "SLOS / SLIs", "Score": 2 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Learning Reviews", "Score": 4 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Knowledge Systems", "Score": 3 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Tooling", "Score": 3 },
            { "Project": "Capability", "Team": "Test Team", "PodSize": "S", "Metric": "Chaos Engineering", "Score": 2 }
        ];
        
        let dashboardData = [];

        let currentSelection = null;
        let targetSelection = null;
        let selectionPhase = 'current'; 
        let sreChart, toilChart, radarChart;
        
        document.addEventListener('DOMContentLoaded', () => {
            const uploadOverlay = document.getElementById('upload-overlay');
            const uploadCard = document.getElementById('upload-card');
            uploadOverlay.style.display = 'flex';
            setTimeout(() => {
                uploadOverlay.classList.remove('bg-slate-900/80', 'backdrop-blur-sm');
                uploadCard.classList.remove('scale-95', 'opacity-0');
            }, 100);

            const fileInput = document.getElementById('excel-upload-input');
            const processBtn = document.getElementById('process-file-btn');

            fileInput.addEventListener('change', () => {
                if (fileInput.files.length > 0) {
                    processBtn.disabled = false;
                } else {
                    processBtn.disabled = true;
                }
            });

            processBtn.addEventListener('click', () => handleFileUpload(fileInput));
            document.getElementById('continue-sample-btn').addEventListener('click', () => initializeApp(sampleDashboardData));
        });

        function initializeApp(data) {
            dashboardData = data;
            
            const uploadOverlay = document.getElementById('upload-overlay');
            const mainContent = document.getElementById('main-content');
            
            uploadOverlay.classList.add('opacity-0');
            mainContent.classList.remove('opacity-0');
            setTimeout(() => {
                uploadOverlay.style.display = 'none';
            }, 500);

            populateMaturityLevels();
            setupMobileMenu();
            populateMatrix();
            populateLifecycle();
            populateLevelsExplainer();
            initDashboard();
            initIntroAnimation();
            
            document.getElementById('reset-selection-btn').addEventListener('click', resetSelection);
            document.getElementById('reupload-btn').addEventListener('click', () => window.location.reload());
            window.addEventListener('resize', () => drawPath(true));
        }


        function populateMaturityLevels() { const container = document.querySelector('#framework .grid'); container.innerHTML = maturityLevelsData.map(level => ` <div class="bg-white p-6 rounded-xl shadow-md border-b-4 border-purple-500 transition hover:shadow-xl hover:-translate-y-1"> <div class="flex items-center mb-4"> <span class="text-4xl mr-4">${level.icon}</span> <div> <p class="text-xs font-bold uppercase tracking-wider text-purple-600">Level ${level.level}</p> <h3 class="text-xl font-bold text-slate-900">${level.name}</h3> </div> </div> <p class="text-slate-600 text-sm">${level.desc}</p> </div> `).join(''); }
        function populateLifecycle() { const container = document.getElementById('lifecycle-steps'); container.innerHTML = lifecycleData.map(step => ` <div class="relative bg-white p-6 rounded-lg shadow-md border-l-4 border-purple-500 w-full md:w-auto step-item"> <p class="text-sm font-bold text-purple-700 mb-1">STEP ${step.step}</p> <h4 class="text-lg font-semibold mb-2">${step.name}</h4> <p class="text-sm text-slate-600 mb-2"><strong>Action:</strong> ${step.action}</p> <p class="text-sm text-slate-500 font-medium"><strong>Output:</strong> ${step.output}</p> </div> `).join(''); }
        function setupMobileMenu() { const button = document.getElementById('mobile-menu-button'); const menu = document.getElementById('mobile-menu'); button.addEventListener('click', () => { menu.classList.toggle('hidden'); }); menu.querySelectorAll('a').forEach(link => { link.addEventListener('click', () => menu.classList.add('hidden')); }); }

        function populateMatrix() {
            const gridContainer = document.getElementById('maturity-matrix-grid');
            gridContainer.innerHTML = '';
            
            const emptyCell = document.createElement('div');
            gridContainer.appendChild(emptyCell);
            
            maturityLevelsData.slice(0, 5).forEach(level => {
                const headerCell = document.createElement('div');
                headerCell.className = 'h-12 flex items-center justify-center font-bold text-slate-600 text-xs sm:text-sm md:text-base text-center';
                headerCell.textContent = level.name;
                gridContainer.appendChild(headerCell);
            });

            podSizes.forEach(size => {
                const yAxisCell = document.createElement('div');
                yAxisCell.className = 'h-full flex items-center justify-center font-bold text-slate-600 bg-slate-100 rounded text-sm md:text-base';
                yAxisCell.textContent = size;
                gridContainer.appendChild(yAxisCell);

                levels.forEach(level => {
                    const cell = document.createElement('div');
                    cell.className = 'matrix-cell selectable rounded-md cursor-pointer flex items-center justify-center text-transparent';
                    const colors = ['#9d4edd', '#7b2cbf', '#5a189a', '#3c096c', '#240046'];
                    cell.style.backgroundColor = colors[level-1];
                    cell.dataset.pod = size;
                    cell.dataset.level = level;
                    cell.id = `cell-${size}-${level}`;
                    cell.addEventListener('click', handleMatrixClick);
                    gridContainer.appendChild(cell);
                });
            });

            const bottomEmptyCell = document.createElement('div');
            gridContainer.appendChild(bottomEmptyCell);

            levels.forEach(level => {
                const footerCell = document.createElement('div');
                footerCell.className = 'h-12 flex items-center justify-center font-bold text-slate-600 text-sm md:text-base';
                footerCell.id = `footer-level-${level}`;
                footerCell.textContent = `Level ${level}`;
                gridContainer.appendChild(footerCell);
            });
        }

        function handleMatrixClick(event) {
            const cell = event.currentTarget;
            if (cell.classList.contains('disabled')) return;

            const selection = { pod: cell.dataset.pod, level: parseInt(cell.dataset.level) };

            if (selectionPhase === 'current') {
                currentSelection = selection;
                cell.classList.add('current-selection');
                
                if (currentSelection.level === 5) {
                    selectionPhase = 'done';
                    document.getElementById('selection-prompt').textContent = 'Level 5 Selected: Aiming for Level X!';
                    document.getElementById('reset-selection-btn').classList.remove('hidden');
                    document.querySelectorAll('.matrix-cell.selectable').forEach(c => {
                        if (!c.classList.contains('current-selection')) c.classList.add('disabled');
                    });
                    showLevelXRecommendations();
                } else {
                    selectionPhase = 'target';
                    document.getElementById('selection-prompt').textContent = 'Select your TARGET maturity';
                    updateDisabledCells();
                    showRecommendation();
                }
            } else if (selectionPhase === 'target') {
                targetSelection = selection;
                document.querySelectorAll('.matrix-cell').forEach(c => c.classList.remove('recommended-target'));
                clearCanvas();
                cell.classList.add('target-selection');
                selectionPhase = 'done';
                document.getElementById('selection-prompt').textContent = 'Uplift Path Selected!';
                document.getElementById('reset-selection-btn').classList.remove('hidden');
                document.querySelectorAll('.matrix-cell.selectable').forEach(c => {
                    if (!c.classList.contains('current-selection') && !c.classList.contains('target-selection')) {
                        c.classList.add('disabled');
                    }
                });
                drawPath(false, '#D97706', true);
                updateRecommendations(currentSelection.pod, currentSelection.level, targetSelection.level);
            }
        }
        
        function updateDisabledCells() {
            if (!currentSelection) return;
            document.querySelectorAll('.matrix-cell.selectable').forEach(cell => {
                const pod = cell.dataset.pod;
                const level = parseInt(cell.dataset.level);
                if (pod !== currentSelection.pod || level <= currentSelection.level) {
                     cell.classList.add('disabled');
                }
            });
        }

        function showRecommendation() {
            if (!currentSelection || currentSelection.level >= 5) return;
            const recommendedTarget = { pod: currentSelection.pod, level: 5 };
            
            const recommendedCell = document.getElementById(`cell-${recommendedTarget.pod}-${recommendedTarget.level}`);
            if(recommendedCell) {
                recommendedCell.classList.add('recommended-target');
            }
            
            drawPath(false, '#16A34A', true, recommendedTarget);
        }

        function resetSelection() {
            currentSelection = null;
            targetSelection = null;
            selectionPhase = 'current';
            document.getElementById('selection-prompt').textContent = 'Select your CURRENT maturity';
            document.getElementById('reset-selection-btn').classList.add('hidden');
            document.querySelectorAll('.matrix-cell').forEach(cell => {
                cell.classList.remove('current-selection', 'target-selection', 'disabled', 'calculated-average-highlight');
            });
            clearCanvas();
            document.getElementById('metric-details-container').classList.add('opacity-0');
            document.getElementById('pod-recommendation-container').classList.add('opacity-0');
        }
        
        function clearCanvas() {
            const canvas = document.getElementById('path-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function drawPath(isResize = false, color = '#D97706', isDashed = false, overrideTarget = null) {
            const endSelection = overrideTarget || targetSelection;
            if (!currentSelection || !endSelection) return;

            const canvas = document.getElementById('path-canvas');
            const gridContainer = document.getElementById('maturity-matrix-grid');
            const ctx = canvas.getContext('2d');

            canvas.width = gridContainer.offsetWidth;
            canvas.height = gridContainer.offsetHeight;

            const startCell = document.getElementById(`cell-${currentSelection.pod}-${currentSelection.level}`);
            const endCell = document.getElementById(`cell-${endSelection.pod}-${endSelection.level}`);
            
            if(!startCell || !endCell) return;

            const startPos = { x: startCell.offsetLeft + startCell.offsetWidth / 2, y: startCell.offsetTop };
            const endPos = { x: endCell.offsetLeft + endCell.offsetWidth / 2, y: endCell.offsetTop };
            
            const point1 = { x: startPos.x, y: startPos.y + startCell.offsetHeight };
            const point2 = { x: startPos.x, y: startPos.y};
            const point3 = { x: endPos.x, y: endPos.y};
            const point4 = { x: endPos.x, y: endPos.y + endCell.offsetHeight };

            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            
            if(isDashed) {
                ctx.setLineDash([8, 6]);
            } else {
                ctx.setLineDash([]);
            }

            ctx.lineWidth = 3;
            ctx.strokeStyle = color;
            ctx.moveTo(point1.x, point1.y);
            ctx.lineTo(point2.x, point2.y);
            ctx.lineTo(point3.x, point3.y);
            ctx.lineTo(point4.x, point4.y);
            ctx.stroke();
            
            drawArrow(ctx, point3.x, point3.y, point4.x, point4.y, color);
        }

        function drawArrow(ctx, fromx, fromy, tox, toy, color) {
            const headlen = 10;
            const dx = tox - fromx;
            const dy = toy - fromy;
            const angle = Math.atan2(dy, dx);
            ctx.save();
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.setLineDash([]);
            ctx.moveTo(tox, toy);
            ctx.lineTo(tox - headlen * Math.cos(angle - Math.PI / 6), toy - headlen * Math.sin(angle - Math.PI / 6));
            ctx.moveTo(tox, toy);
            ctx.lineTo(tox - headlen * Math.cos(angle + Math.PI / 6), toy - headlen * Math.sin(angle + Math.PI / 6));
            ctx.stroke();
            ctx.restore();
        }

        function updateRecommendations(podSize, currentLevel, targetLevel) {
            updateMetricDetailsTable(currentLevel, targetLevel);

            const podContainer = document.getElementById('pod-recommendation-container');
            let baseCompositionData = podDataMatrix[podSize]?.[targetLevel];
            let recommendationNote = '';
            
            if (!baseCompositionData) {
                const availableLevels = Object.keys(podDataMatrix[podSize] || {}).map(Number).sort((a,b) => a-b);
                const fallbackLevel = availableLevels[0];
                if (fallbackLevel) {
                    baseCompositionData = podDataMatrix[podSize][fallbackLevel];
                    recommendationNote = `<p class="text-xs text-center text-slate-500 mt-4">(Note: Composition based on the foundational team required for a Level ${fallbackLevel} transformation for this POD size.)</p>`;
                }
            }
            
            if (!baseCompositionData) {
                podContainer.innerHTML = `<p class="text-center text-slate-500">No recommendation available for this POD size.</p>`;
                podContainer.classList.remove('opacity-0');
                return;
            }

            const upliftCount = targetLevel - currentLevel;
            const scalingFactor = 0.4 + (upliftCount / 4) * 0.6;

            const scaledRoles = {};
            for (const role in baseCompositionData.roles) {
                const baseRole = baseCompositionData.roles[role];
                const scaledCount = Math.max(1, Math.ceil(baseRole.count * scalingFactor));
                scaledRoles[role] = { count: scaledCount, alloc: baseRole.alloc };
            }

            const rolesHTML = Object.entries(scaledRoles).map(([role, details]) => {
                const allocationText = `${details.count} (${details.alloc}%)`;
                return ` <li class="flex justify-between items-center py-2 border-b border-slate-100"> <span class="font-medium">${role}</span> <span class="text-sm font-semibold text-purple-700 bg-purple-100 px-2 py-1 rounded-full">${allocationText}</span> </li> `;
            }).join('');

            podContainer.innerHTML = ` <div class="mb-4"> <p class="text-sm font-bold uppercase tracking-wider text-slate-500">Selected POD Size: ${podSize} | Journey: Lvl ${currentLevel} → Lvl ${targetLevel}</p> <h3 class="text-2xl font-bold text-purple-700">${baseCompositionData.category}</h3> </div> <div> <h4 class="text-lg font-semibold mb-3">Recommended Team Composition</h4> <ul class="space-y-1">${rolesHTML}</ul> </div> ${recommendationNote}`;
            podContainer.classList.remove('opacity-0');
        }

        function updateMetricDetailsTable(currentLevel, targetLevel) {
            const detailsContainer = document.getElementById('metric-details-container');
            document.getElementById('target-level-display').textContent = `Level ${targetLevel}`;
            const tableContainer = document.getElementById('metric-details');
            let tableHTML = `<table class="min-w-full bg-white border border-slate-200"> <thead class="bg-slate-50"> <tr> <th class="py-3 px-4 text-left font-semibold text-slate-700 text-sm">SRE Metric</th>`;
            
            for(let i = 1; i <= targetLevel; i++) {
                let highlightClass = '';
                if (i === currentLevel) {
                    highlightClass = 'highlight-current';
                } else if (i === targetLevel) {
                    highlightClass = 'highlight-target';
                }
                tableHTML += `<th class="py-3 px-4 text-left font-semibold text-slate-700 text-sm ${highlightClass}">Level ${i}</th>`; 
            }
            tableHTML += `</tr></thead><tbody class="divide-y divide-slate-200">`;
            
            metrics.forEach(metric => { 
                tableHTML += `<tr><td class="py-3 px-4 font-medium text-sm text-slate-800">${metric}</td>`; 
                const criteria = metricCriteria[metric]; 
                for(let i = 0; i < targetLevel; i++) { 
                    let highlightClass = '';
                     if ((i + 1) === currentLevel) {
                        highlightClass = 'highlight-current';
                    } else if ((i + 1) === targetLevel) {
                        highlightClass = 'highlight-target';
                    }
                    tableHTML += `<td class="py-3 px-4 text-sm text-slate-600 ${highlightClass}">${criteria[i] || 'N/A'}</td>`; 
                } 
                tableHTML += `</tr>`; 
            });
            tableHTML += `</tbody></table>`;
            tableContainer.innerHTML = tableHTML;
            detailsContainer.classList.remove('opacity-0');
        }

        function showLevelXRecommendations() {
            const podContainer = document.getElementById('pod-recommendation-container');
            const data = podDataMatrix['XL']['5']; 

            const rolesHTML = Object.entries(data.roles).map(([role, details]) => {
                 const allocationText = `${details.count} (${details.alloc}%)`;
                return ` <li class="flex justify-between items-center py-2 border-b border-slate-100"> <span class="font-medium">${role}</span> <span class="text-sm font-semibold text-purple-700 bg-purple-100 px-2 py-1 rounded-full">${allocationText}</span> </li> `
            }).join('');
            podContainer.innerHTML = ` <div class="mb-4"> <p class="text-sm font-bold uppercase tracking-wider text-slate-500">Required POD Size for Level X: XL</p> <h3 class="text-2xl font-bold text-purple-700">${data.category}</h3> </div> <div> <h4 class="text-lg font-semibold mb-3">Team Composition for Transformation</h4> <ul class="space-y-1">${rolesHTML}</ul> </div> `;
            podContainer.classList.remove('opacity-0');

            const detailsContainer = document.getElementById('metric-details-container');
            document.getElementById('target-level-display').innerHTML = `Level X <span class="text-lg font-normal text-slate-500">(Emergent)</span>`;
            const tableContainer = document.getElementById('metric-details');
            let tableHTML = `<table class="min-w-full bg-white border border-slate-200"> <thead class="bg-slate-100"> <tr> <th class="py-3 px-4 text-left font-semibold text-slate-700 text-sm">SRE Metric</th> <th class="py-3 px-4 text-left font-semibold text-slate-700 text-sm highlight-target">Level X Goal</th></tr></thead><tbody class="divide-y divide-slate-200">`;
            metrics.forEach(metric => {
                const criteria = metricCriteria[metric][5] || 'N/A';
                tableHTML += `<tr><td class="py-3 px-4 font-medium text-sm text-slate-800">${metric}</td><td class="py-3 px-4 text-sm text-slate-600 highlight-target">${criteria}</td></tr>`;
            });
            tableHTML += `</tbody></table>`;
            tableContainer.innerHTML = tableHTML;
            detailsContainer.classList.remove('opacity-0');
        }

        // --- DASHBOARD ---
        function handleFileUpload(inputElement) {
            const file = inputElement.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    
                    const sheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[sheetName];
                    let json = XLSX.utils.sheet_to_json(worksheet);
                    
                    if(json.length > 0) {
                        const headers = Object.keys(json[0]).map(h => h.toLowerCase());
                        const requiredHeaders = ['project', 'team', 'podsize', 'metric', 'score'];
                        const hasRequiredHeaders = requiredHeaders.every(h => headers.includes(h));
                        if (!hasRequiredHeaders) {
                             alert(`Error: The sheet must contain the columns: Project, Team, PodSize, Metric, Score.`);
                             return;
                        }
                    } else {
                        alert('The data sheet is empty.');
                        return;
                    }
                    
                    json = json.map(row => {
                        const newRow = {};
                        for (const key in row) {
                            const lowerKey = key.toLowerCase();
                            if (lowerKey === 'project') newRow.Project = row[key];
                            else if (lowerKey === 'team') newRow.Team = row[key];
                            else if (lowerKey === 'podsize') newRow.PodSize = row[key];
                            else if (lowerKey === 'metric') newRow.Metric = row[key];
                            else if (lowerKey === 'score') newRow.Score = row[key];
                            else newRow[key] = row[key];
                        }
                        return newRow;
                    });

                    initializeApp(json);
                } catch(err) {
                    console.error("File parsing error:", err);
                    alert("There was an error processing the file. Please ensure it's a valid Excel or CSV file and matches the template.");
                }
            };
            reader.readAsArrayBuffer(file);
        }

        function initDashboard() {
            initCharts();
            populateDashboardFilters();
            const projectSelect = document.getElementById('project-select');
            const teamSelect = document.getElementById('team-select');
            
            projectSelect.addEventListener('change', populateTeamFilter);
            teamSelect.addEventListener('change', updateDashboardVisuals);
            
            populateTeamFilter();
        }

        function populateDashboardFilters() {
            const projects = [...new Set(dashboardData.map(item => item.Project))];
            const projectSelect = document.getElementById('project-select');
            projectSelect.innerHTML = projects.map(p => `<option value="${p}">${p}</option>`).join('');
        }

        function populateTeamFilter() {
            const selectedProject = document.getElementById('project-select').value;
            const teams = [...new Set(dashboardData.filter(item => item.Project === selectedProject).map(item => item.Team))];
            const teamSelect = document.getElementById('team-select');
            teamSelect.innerHTML = teams.map(t => `<option value="${t}">${t}</option>`).join('');
            updateDashboardVisuals();
        }

        function updateDashboardVisuals() {
            const selectedProject = document.getElementById('project-select').value;
            const selectedTeam = document.getElementById('team-select').value;
            
            const teamData = dashboardData.filter(item => item.Project === selectedProject && item.Team === selectedTeam);
            
            renderHeatmap(selectedProject);
            updateCharts(teamData);
            updateAverageMaturityBadge(teamData);
        }
        
        function updateAverageMaturityBadge(teamData) {
            const container = document.getElementById('average-maturity-display');
            if (!teamData || teamData.length === 0) {
                container.innerHTML = '';
                return;
            }

            const totalScore = teamData.reduce((acc, item) => acc + item.Score, 0);
            const averageScore = Math.round(totalScore / teamData.length);
            const podSize = teamData[0]?.PodSize;

            const levelData = maturityLevelsData.find(l => l.level === averageScore);
            const colors = ['#9d4edd', '#7b2cbf', '#5a189a', '#3c096c', '#240046'];
            const color = averageScore > 0 ? colors[averageScore - 1] : '#E5E7EB';

            if(levelData) {
                 container.innerHTML = `
                    <div class="text-center">
                        <p class="text-sm font-medium text-slate-500 mb-1">Avg. Maturity</p>
                        <div class="inline-flex items-center justify-center p-2 rounded-full" style="background-color: ${color}20;">
                            <div class="w-16 h-16 rounded-full flex items-center justify-center text-white text-2xl font-bold" style="background-color: ${color};">
                                ${levelData.icon}
                            </div>
                        </div>
                        <p class="font-bold text-slate-800 mt-1">Level ${levelData.level}: ${levelData.name}</p>
                    </div>
                 `;
            } else {
                 container.innerHTML = '';
            }
            
            // Highlight the cell in the explorer
            document.querySelectorAll('.matrix-cell').forEach(c => c.classList.remove('calculated-average-highlight'));
            if(podSize && averageScore) {
                const targetCell = document.getElementById(`cell-${podSize}-${averageScore}`);
                if(targetCell) {
                    targetCell.classList.add('calculated-average-highlight');
                }
            }
        }


        function renderHeatmap(selectedProject) {
            const container = document.getElementById('heatmap-container');
            const projectData = dashboardData.filter(d => d.Project === selectedProject);
            const teams = [...new Set(projectData.map(d => d.Team))];
            const projectMetrics = [...new Set(projectData.map(d => d.Metric))];
            const heatmapColors = ['#9d4edd', '#7b2cbf', '#5a189a', '#3c096c', '#240046'];

            let html = `<div class="heatmap-grid" style="grid-template-columns: 1fr repeat(${teams.length}, 1fr);">`;
            html += '<div class="font-bold text-sm text-slate-700 p-2 border-b border-r">Metric</div>';
            teams.forEach(team => {
                html += `<div class="font-bold text-sm text-slate-700 p-2 text-center border-b">${team}</div>`;
            });

            projectMetrics.forEach(metric => {
                html += `<div class="font-medium text-sm text-slate-600 p-2 border-r">${metric}</div>`;
                teams.forEach(team => {
                    const item = projectData.find(d => d.Team === team && d.Metric === metric);
                    const score = item ? item.Score : 0;
                    const color = score > 0 ? heatmapColors[score - 1] || '#E5E7EB' : '#F3F4F6';
                    html += `<div class="heatmap-cell" style="background-color: ${color};">${score || 'N/A'}</div>`;
                });
            });

            html += '</div>';
            container.innerHTML = html;
        }

        function initCharts() {
            const barCtx = document.getElementById('sre-kpi-chart').getContext('2d');
            sreChart = new Chart(barCtx, { type: 'bar', data: { labels:[], datasets:[]}, options: { responsive: true, maintainAspectRatio: false, scales: { y: { beginAtZero: true, max: 5 }, x: { ticks: { autoSkip: false, maxRotation: 45, minRotation: 45, font: { size: 10 } } } }, plugins: { legend: { position: 'top', }, title: { display: true, text: 'Current Maturity Scores', font: { size: 16 } } } } });
            const toilCtx = document.getElementById('toil-chart').getContext('2d');
            toilChart = new Chart(toilCtx, { type: 'doughnut', data: { labels:[], datasets:[]}, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Toil Reduction Progress', font: { size: 16 } } } } });
            const radarCtx = document.getElementById('maturity-radar-chart').getContext('2d');
            radarChart = new Chart(radarCtx, { type: 'radar', data: { labels:[], datasets:[]}, options: { responsive: true, maintainAspectRatio: false, scales: { r: { beginAtZero: true, max: 5, stepSize: 1, pointLabels: { font: { size: 9 } } } }, plugins: { legend: { display: false }, title: { display: true, text: 'SRE Maturity Profile', font: { size: 16 } } } } });
        }
        
        function updateCharts(teamData) {
            if (!sreChart || !toilChart || !radarChart || !teamData || teamData.length === 0) return;
            
            const selectedTeam = document.getElementById('team-select').value;
            const labels = teamData.map(d => d.Metric);
            const scores = teamData.map(d => d.Score);

            sreChart.options.plugins.title.text = `Current Maturity Scores (${selectedTeam})`;
            sreChart.data.labels = labels;
            sreChart.data.datasets = [{ label: 'Score', data: scores, backgroundColor: 'rgba(167, 139, 250, 0.6)', borderColor: 'rgba(139, 92, 246, 1)', borderWidth: 1, borderRadius: 4 }];
            sreChart.update();
            
            const toilScore = teamData.find(d => d.Metric === 'Toil Management')?.Score || 0;
            const automationPercentage = toilScore * 20; 
            toilChart.data.labels = [`Automated (${automationPercentage}%)`, `Manual (${100 - automationPercentage}%)`];
            toilChart.data.datasets = [{
                data: [automationPercentage, 100 - automationPercentage],
                backgroundColor: ['rgba(52, 211, 153, 0.7)', `rgba(244, 63, 94, 0.7)`],
                borderColor: ['rgba(16, 185, 129, 1)', `rgba(225, 29, 72, 1)`],
                borderWidth: 1
            }];
            toilChart.update();

            radarChart.data.labels = metrics.map(m => m.replace(/ & | /g, '\n'));
            const radarScores = metrics.map(metric => teamData.find(d => d.Metric === metric)?.Score || 0);
            radarChart.data.datasets[0] = {
                label: 'Current Maturity Profile',
                data: radarScores,
                fill: true,
                backgroundColor: 'rgba(139, 92, 246, 0.2)',
                borderColor: 'rgba(139, 92, 246, 1)',
                pointBackgroundColor: 'rgba(139, 92, 246, 1)',
                pointBorderColor: '#fff',
                pointHoverBackgroundColor: '#fff',
                pointHoverBorderColor: 'rgba(139, 92, 246, 1)'
            };
            radarChart.update();
        }


        function initIntroAnimation() {
            const playButton = document.getElementById('play-animation-btn');
            playButton.dataset.status = 'stopped';
            const synth = window.speechSynthesis;
            let utterance = null;
            let currentStep = 0;

            const animationScript = [
                { text: "This matrix visualizes the effort and progression needed to uplift different project sizes, from extra-small to extra-large, through the SRE Framework maturity stages — from Level 1 (Guiding) to Level 5 (Intelligent).", highlights: [] },
                { text: "The Y-axis shows POD sizes. As you go up, the scope and complexity of the project increases.", highlights: ['intro-pod-size-label-1', 'intro-pod-size-label-2', 'intro-pod-size-label-3', 'intro-pod-size-label-4', 'intro-pod-size-label-5'] },
                { text: "The X-axis represents maturity levels. Each level requires more advanced capabilities.", highlights: ['intro-level-label-1', 'intro-level-label-2', 'intro-level-label-3', 'intro-level-label-4', 'intro-level-label-5'] },
                { text: "The shaded cells show a project's current position and its target. For instance, a large project might currently be at level 3, aiming for level 5.", highlights: ['intro-cell-3-4', 'intro-cell-5-4'] },
                { text: "The dashed lines illustrate the uplift journey. Notice how they trace the path from a team’s current level to their goal.", highlights: [], path: { id: 'all' } },
                { text: "The color intensity deepens as you move to the right, symbolizing the increased resources, time, and skills needed for higher levels.", highlights: ['intro-cell-1-4', 'intro-cell-2-4', 'intro-cell-3-4', 'intro-cell-4-4', 'intro-cell-5-4'] },
                { text: "Finally, the timeline bar at the bottom shows that larger pods generally take longer to advance through each level.", highlights: [] },
                { text: "And that's a quick tour of the PODs Maturity Matrix.", highlights: [] }
            ];

            function runAnimationStep() {
                if (currentStep >= animationScript.length) {
                    playButton.innerText = "▶ Replay PODs Animation";
                    playButton.dataset.status = 'stopped';
                    currentStep = 0;
                    document.querySelectorAll('.intro-highlight-cell, .visible').forEach(el => el.classList.remove('intro-highlight-cell', 'visible'));
                    return;
                }
                document.querySelectorAll('.intro-highlight-cell, .visible').forEach(el => el.classList.remove('intro-highlight-cell', 'visible'));
                const step = animationScript[currentStep];
                utterance = new SpeechSynthesisUtterance(step.text);
                utterance.rate = 0.9; 
                utterance.pitch = 1.0; 
                utterance.onstart = () => {
                    step.highlights.forEach(id => { const el = document.getElementById(id); if (el) {el.classList.add('intro-highlight-cell');} });
                    if (step.path && step.path.id === 'all') {
                        document.querySelectorAll('.intro-uplift-path, .intro-path-dot').forEach(el => el.classList.add('visible'));
                    }
                };
                utterance.onend = () => {
                    if(playButton.dataset.status === 'playing') {
                        step.highlights.forEach(id => { const el = document.getElementById(id); if (el) {el.classList.remove('intro-highlight-cell');} });
                        currentStep++;
                        runAnimationStep();
                    }
                };
                synth.speak(utterance);
            }

            playButton.addEventListener('click', () => {
                 if (synth.speaking) { synth.cancel(); }
                 
                if (playButton.dataset.status === 'playing') {
                    playButton.dataset.status = 'stopped';
                    playButton.innerText = "▶ Play PODs Animation";
                } else if (playButton.dataset.status === 'paused') {
                    playButton.dataset.status = 'playing';
                    playButton.innerText = "❚❚ Stop Animation";
                    synth.resume();
                } else {
                    currentStep = 0;
                    playButton.dataset.status = 'playing';
                    playButton.innerText = "❚❚ Stop Animation";
                    setTimeout(runAnimationStep, 100);
                }
            });

            function drawIntroPaths() {
                const paths = [
                    { id: 'path1', from: 'intro-cell-1-1', to: 'intro-cell-4-1' }, { id: 'path2', from: 'intro-cell-1-2', to: 'intro-cell-4-2' },
                    { id: 'path3', from: 'intro-cell-2-3', to: 'intro-cell-5-3' }, { id: 'path4', from: 'intro-cell-3-4', to: 'intro-cell-5-5' },
                ];
                const dotsContainer = document.getElementById('dots-container');
                dotsContainer.innerHTML = ''; 
                paths.forEach(p => {
                    const fromEl = document.getElementById(p.from); const toEl = document.getElementById(p.to); const pathEl = document.getElementById(p.id);
                    if (fromEl && toEl && pathEl) {
                        const startX = fromEl.offsetLeft + fromEl.offsetWidth / 2; const startY = fromEl.offsetTop + fromEl.offsetHeight / 2;
                        const endX = toEl.offsetLeft + toEl.offsetWidth / 2; const endY = toEl.offsetTop + toEl.offsetHeight / 2;
                        const pathData = `M ${startX},${startY} L ${startX},${endY} L ${endX},${endY}`;
                        pathEl.setAttribute('d', pathData);
                        ['from', 'to'].forEach(point => {
                            const dot = document.createElement('div');
                            dot.className = 'intro-path-dot';
                            dot.style.left = point === 'from' ? `${startX}px` : `${endX}px`;
                            dot.style.top = point === 'from' ? `${startY}px` : `${endY}px`;
                            dot.id = `dot-${p[point]}`;
                            dotsContainer.appendChild(dot);
                        });
                    }
                });
            }
            setTimeout(drawIntroPaths, 100);
            window.addEventListener('resize', () => setTimeout(drawIntroPaths, 100));
        }

        function populateLevelsExplainer() {
            const container = document.getElementById('levels-infographic-container');
            if(!container) return;
            container.innerHTML = '';
            const headerColors = ['#9d4edd', '#7b2cbf', '#5a189a', '#3c096c', '#240046', '#fca5a5'];
            
            maturityLevelsData.forEach((level, index) => {
                const card = document.createElement('div');
                card.className = 'level-card rounded-lg bg-white shadow-md flex flex-col';
                card.style.borderColor = headerColors[index];

                card.innerHTML = `
                    <div class="p-4 rounded-t-lg" style="background-color: ${headerColors[index]}">
                        <h3 class="text-xl font-bold text-white text-center">Level ${level.level}: ${level.name}</h3>
                    </div>
                    <div class="p-6 flex-grow">
                        <p class="text-5xl text-center mb-4">${level.icon}</p>
                        <div class="mb-4">
                            <h4 class="font-bold text-slate-800">Description</h4>
                            <p class="text-slate-600 text-sm">${level.desc}</p>
                        </div>
                        <div>
                            <h4 class="font-bold text-slate-800">Analogy</h4>
                            <p class="text-slate-600 text-sm">${level.analogy}</p>
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
    </script>
</body>
</html>
